CORS HEADER OVERRIDE BUG - ROOT CAUSE IDENTIFIED

PROBLEM:
- Browser: Sees Access-Control-Allow-Origin: * (WRONG)
- curl: Sees Access-Control-Allow-Origin: http://localhost:3000 (CORRECT)
- This breaks credentials-enabled requests from browsers

INVESTIGATION FINDINGS:

1. EXPRESS CORS MIDDLEWARE (server.ts lines 65-80) ✓ CORRECT
   - Uses dynamic callback validation function
   - Sets specific origin, not wildcard
   - Properly supports credentials: true
   - No issues found

2. SOCKET.IO CORS CONFIGURATION (socket.ts lines 36-53) ⚠️ CULPRIT FOUND
   - Uses array-based origin validation: origin: [ 'list', 'of', 'urls' ]
   - Sets credentials: true
   - Includes HTTP polling transport: transports: ['websocket', 'polling']
   
3. ROOT CAUSE: Socket.io Polling + engine.io
   - Browser requests may fall back to HTTP polling if WebSocket unavailable
   - Socket.io polling uses engine.io layer
   - engine.io with array origins + credentials has undefined/wildcard behavior
   - curl directly hits Express CORS (doesn't use Socket.io)
   
   This explains: Browser != curl behavior!

CODE LOCATIONS AFFECTED:
- File: server/src/config/socket.ts
- Lines: 36-53
- Function: initializeSocketIO()

NO MANUAL HEADER ISSUES FOUND:
- Scanned 13 middleware files - NO setHeader/header calls with Access-Control
- Scanned 15 controller files - NO header manipulation
- Scanned all routes - NO header manipulation
- Checked error handlers - NOT overwriting CORS headers
- Checked nginx config - NO CORS issues
- Helmet is disabled - NOT an issue

SOLUTION:
Convert Socket.io CORS from array-based to callback-based validation,
matching the working Express CORS pattern already in place.

See detailed report: CORS_DEBUG_DETAILED_REPORT.md
