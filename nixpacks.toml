# Nixpacks configuration for Railway
# This builds the server for the monorepo

# Disable auto-detection
providers = []

[phases.setup]
nixPkgs = ["nodejs_22"]

[phases.install]
cmds = [
  "npm install --ignore-scripts",
  "cd shared && npm install --ignore-scripts && npm run build",
  "cd server && npm install --ignore-scripts",
  "cd server && npm run build:ci"
]

# Disable default build phase
[phases.build]
cmds = ["echo 'Build completed in install phase'"]

[start]
cmd = "cd server && npm start"
