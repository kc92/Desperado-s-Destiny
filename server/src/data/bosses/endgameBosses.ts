/**
 * Endgame Bosses - Level 45-50
 *
 * Ultimate challenges for prestiged players
 * These are the final tests before achieving the highest ranks
 */

import {
  BossEncounter,
  BossCategory,
  BossTier,
  BossDamageType,
  StatusEffect,
  BossAbilityType,
  BossSpawnConditionType,
} from '@desperados/shared';

/**
 * THE COSMIC SERPENT - Level 45
 * A reality-warping entity that slithers between dimensions
 */
export const THE_COSMIC_SERPENT: BossEncounter = {
  id: 'boss_cosmic_serpent',
  name: 'The Cosmic Serpent',
  title: 'Devourer of Dimensions',
  category: BossCategory.COSMIC_HORROR,
  tier: BossTier.MYTHIC,
  level: 45,

  description: 'A serpentine entity that exists simultaneously across multiple dimensions. Where it passes, reality buckles and warps.',
  backstory: 'Long before the settlers came, the native peoples spoke of Uktena - a great horned serpent that could swallow the sun. The Cosmic Serpent is the truth behind the legend, a being from before time that has awakened in response to the disturbances in The Scar.',
  defeatDialogue: '*The serpent coils in on itself, folding through dimensions until it simply isn\'t there anymore. The air tastes wrong for weeks afterward.*',
  victoryNarrative: 'The Cosmic Serpent retreats to dimensions beyond reach. But through the tears it left behind, you glimpse countless other realities - and in each one, something stares back.',

  location: 'The Shifting Wastes',
  spawnConditions: [
    {
      type: BossSpawnConditionType.LEVEL,
      value: 45,
      description: 'Must be level 45 or higher',
    },
    {
      type: BossSpawnConditionType.QUEST,
      value: 1,
      description: 'Must have prestiged at least once',
    },
  ],
  respawnCooldown: 168, // 1 week

  health: 25000,
  damage: 280,
  defense: 90,
  criticalChance: 0.20,
  evasion: 0.30,

  phases: [
    {
      phaseNumber: 1,
      healthThreshold: 100,
      name: 'The Emergence',
      description: 'The serpent emerges from between worlds.',
      dialogue: '*Reality tears open like a wound, and something ancient slides through*',
      abilities: ['dimensional_bite', 'reality_coil', 'warp_strike'],
      modifiers: [],
    },
    {
      phaseNumber: 2,
      healthThreshold: 75,
      name: 'The Hunt',
      description: 'The serpent phases through dimensions, striking from nowhere.',
      dialogue: '*It vanishes - and reappears BEHIND you*',
      abilities: ['dimensional_bite', 'reality_coil', 'warp_strike', 'phase_shift', 'dimensional_ambush'],
      modifiers: [
        {
          type: 'damage',
          multiplier: 1.3,
          description: '+30% damage',
        },
      ],
      environmentalHazard: {
        name: 'Dimensional Instability',
        description: 'Reality flickers around you',
        damagePerTurn: 30,
        avoidable: true,
      },
    },
    {
      phaseNumber: 3,
      healthThreshold: 50,
      name: 'The Constriction',
      description: 'The serpent wraps reality itself around you.',
      dialogue: '*Space itself coils tighter and tighter...*',
      abilities: ['phase_shift', 'dimensional_ambush', 'reality_crush', 'summon_echoes'],
      modifiers: [
        {
          type: 'damage',
          multiplier: 1.6,
          description: '+60% damage',
        },
      ],
      summonMinions: {
        type: 'dimensional_echo',
        count: 4,
        spawnMessage: 'Echoes of the serpent from other realities appear!',
      },
    },
    {
      phaseNumber: 4,
      healthThreshold: 25,
      name: 'The Unmaking',
      description: 'The serpent begins to unmake the local reality.',
      dialogue: '*"EVERYTHING YOU KNOW IS A DREAM. I AM THE WAKING."*',
      abilities: ['reality_crush', 'dimensional_cascade', 'existence_devour'],
      modifiers: [
        {
          type: 'damage',
          multiplier: 2.0,
          description: '+100% damage',
        },
      ],
      environmentalHazard: {
        name: 'Reality Collapse',
        description: 'The world is unmaking itself',
        damagePerTurn: 75,
        avoidable: false,
      },
    },
  ],

  abilities: [
    {
      id: 'dimensional_bite',
      name: 'Dimensional Bite',
      description: 'Strikes from an impossible angle',
      type: BossAbilityType.DAMAGE,
      cooldown: 0,
      damage: 240,
      damageType: BossDamageType.REALITY,
      avoidable: false,
      priority: 5,
      targetType: 'single',
    },
    {
      id: 'reality_coil',
      name: 'Reality Coil',
      description: 'Wraps distorted space around targets',
      type: BossAbilityType.DEBUFF,
      cooldown: 3,
      damage: 80,
      damageType: BossDamageType.VOID,
      effect: {
        type: StatusEffect.ROOT,
        duration: 3,
        power: 70,
        stackable: false,
        appliedAt: new Date(),
      },
      avoidable: true,
      avoidMechanic: 'Keep moving to avoid reality locks',
      priority: 7,
      targetType: 'single',
    },
    {
      id: 'warp_strike',
      name: 'Warp Strike',
      description: 'Attacks through folded space',
      type: BossAbilityType.DAMAGE,
      cooldown: 2,
      damage: 300,
      damageType: BossDamageType.REALITY,
      avoidable: true,
      avoidMechanic: 'Watch for spatial distortions',
      telegraphMessage: 'Space begins to fold...',
      priority: 6,
      targetType: 'single',
    },
    {
      id: 'phase_shift',
      name: 'Phase Shift',
      description: 'Shifts between dimensions',
      type: BossAbilityType.BUFF,
      cooldown: 4,
      avoidable: false,
      telegraphMessage: 'The serpent flickers between realities...',
      priority: 8,
      requiresPhase: 2,
      targetType: 'single',
    },
    {
      id: 'dimensional_ambush',
      name: 'Dimensional Ambush',
      description: 'Emerges from another dimension to strike',
      type: BossAbilityType.DAMAGE,
      cooldown: 5,
      damage: 450,
      damageType: BossDamageType.VOID,
      avoidable: true,
      avoidMechanic: 'Stay alert for reality tears',
      telegraphMessage: 'A dimensional rift opens behind you!',
      priority: 9,
      requiresPhase: 2,
      targetType: 'all',
    },
    {
      id: 'reality_crush',
      name: 'Reality Crush',
      description: 'Compresses space around targets',
      type: BossAbilityType.AOE,
      cooldown: 6,
      damage: 500,
      damageType: BossDamageType.REALITY,
      avoidable: false,
      telegraphMessage: 'Space is being compressed!',
      priority: 10,
      requiresPhase: 3,
      targetType: 'all',
    },
    {
      id: 'summon_echoes',
      name: 'Summon Dimensional Echoes',
      description: 'Calls versions of itself from other realities',
      type: BossAbilityType.SUMMON,
      cooldown: 8,
      avoidable: false,
      telegraphMessage: 'Other realities bleed through!',
      priority: 7,
      requiresPhase: 3,
      targetType: 'all',
    },
    {
      id: 'dimensional_cascade',
      name: 'Dimensional Cascade',
      description: 'Multiple reality tears explode simultaneously',
      type: BossAbilityType.ULTIMATE,
      cooldown: 7,
      damage: 700,
      damageType: BossDamageType.VOID,
      avoidable: true,
      avoidMechanic: 'Avoid the cascade pattern',
      telegraphMessage: 'DIMENSIONS ARE COLLIDING',
      priority: 10,
      requiresPhase: 4,
      targetType: 'all',
    },
    {
      id: 'existence_devour',
      name: 'Existence Devour',
      description: 'Attempts to consume your very existence',
      type: BossAbilityType.ULTIMATE,
      cooldown: 10,
      damage: 999,
      damageType: BossDamageType.REALITY,
      avoidable: true,
      avoidMechanic: 'Anchor yourself or be erased',
      telegraphMessage: 'THE SERPENT OPENS ITS MAW TO DEVOUR REALITY',
      priority: 10,
      requiresPhase: 4,
      targetType: 'single',
    },
  ],

  weaknesses: [
    {
      damageType: BossDamageType.DIVINE,
      multiplier: 1.5,
      description: 'Sacred weapons damage it',
    },
    {
      damageType: BossDamageType.FIRE,
      multiplier: 1.3,
      description: 'Fire burns through its dimensional shields',
    },
  ],
  immunities: [BossDamageType.PHYSICAL, BossDamageType.POISON],

  specialMechanics: [
    {
      id: 'reality_anchors',
      name: 'Maintain Reality Anchors',
      description: 'Keep anchors stable to prevent dimensional collapse',
      type: 'coordination',
      instructions: 'Players must take turns maintaining 3 reality anchors',
      successReward: 'Reduced dimensional damage',
      failureConsequence: 'Massive AOE damage',
    },
    {
      id: 'phase_tracking',
      name: 'Track Phase Shifts',
      description: 'Predict where the serpent will reappear',
      type: 'puzzle',
      instructions: 'Watch the dimensional ripples to anticipate attacks',
      successReward: 'Counter-attack opportunity',
    },
  ],

  environmentEffects: [
    {
      id: 'dimensional_flux',
      name: 'Dimensional Flux',
      description: 'Reality is unstable here',
      triggersAt: 'start',
      effect: {
        type: 'damage',
        target: 'player',
        power: 25,
      },
      duration: undefined,
    },
  ],

  playerLimit: {
    min: 1,
    max: 5,
    recommended: 4,
  },

  scaling: {
    healthPerPlayer: 70,
    damagePerPlayer: 18,
  },

  guaranteedDrops: [
    {
      itemId: 'serpent_scale',
      name: 'Scale of the Cosmic Serpent',
      rarity: 'mythic',
      quantity: 1,
      guaranteedFirstKill: true,
    },
  ],

  lootTable: [
    {
      itemId: 'dimensional_fang',
      name: 'Dimensional Fang',
      description: 'A fang that exists in multiple realities',
      rarity: 'legendary',
      dropChance: 0.5,
      minQuantity: 1,
      maxQuantity: 2,
    },
    {
      itemId: 'reality_essence',
      name: 'Essence of Reality',
      description: 'Stabilized reality in physical form',
      rarity: 'epic',
      dropChance: 0.7,
      minQuantity: 3,
      maxQuantity: 6,
    },
  ],

  goldReward: {
    min: 8000,
    max: 15000,
  },
  experienceReward: 25000,

  achievements: ['serpent_slayer', 'reality_survivor', 'dimension_hopper'],
  titles: ['Serpent Slayer', 'Reality Survivor', 'Dimension Hopper'],
  firstKillBonus: {
    title: 'Bane of the Cosmic Serpent',
    item: 'serpent_trophy',
    gold: 5000,
  },

  difficulty: 10,
  enrageTimer: 35,
  canFlee: true,
  fleeConsequence: 'Reality permanently unstable in this area',
};

/**
 * GENERAL SANGRE'S SHADE - Level 47
 * The vengeful spirit of the infamous General Sangre
 */
export const GENERAL_SANGRES_SHADE: BossEncounter = {
  id: 'boss_sangre_shade',
  name: "General Sangre's Shade",
  title: 'The Eternal Commander',
  category: BossCategory.ULTIMATE,
  tier: BossTier.MYTHIC,
  level: 47,

  description: 'The spectral form of General Sangre, the territory\'s namesake. In death, he commands legions of ghost soldiers and phases between the physical and ethereal planes.',
  backstory: 'General Sangre conquered this land with blood and iron. When he died, his hatred was so great that death couldn\'t hold him. Now he wages eternal war from beyond the grave, seeking to reclaim what was his.',
  defeatDialogue: '"You may have won this battle... but the war is eternal. I shall return, as I always do. This land is MINE."',
  victoryNarrative: 'General Sangre\'s shade dissolves, screaming, into the earth. But in the blood-red dust, you see his form already reconstituting. He will be back.',

  location: 'Sangre Fortress Ruins',
  spawnConditions: [
    {
      type: BossSpawnConditionType.LEVEL,
      value: 47,
      description: 'Must be level 47 or higher',
    },
    {
      type: BossSpawnConditionType.QUEST,
      value: 1,
      description: 'Must have prestiged at least once',
    },
  ],
  respawnCooldown: 168,

  health: 32000,
  damage: 320,
  defense: 100,
  criticalChance: 0.25,
  evasion: 0.35,

  phases: [
    {
      phaseNumber: 1,
      healthThreshold: 100,
      name: 'The General Appears',
      description: 'Sangre manifests on the battlefield.',
      dialogue: '"At last, a worthy foe. En garde!"',
      abilities: ['spectral_saber', 'ghostly_charge', 'commanders_presence'],
      modifiers: [],
    },
    {
      phaseNumber: 2,
      healthThreshold: 75,
      name: 'The Ethereal Shift',
      description: 'Sangre phases between physical and ghostly forms.',
      dialogue: '"You cannot hit what you cannot touch!"',
      abilities: ['spectral_saber', 'ghostly_charge', 'commanders_presence', 'phase_shift', 'ethereal_ambush'],
      modifiers: [
        {
          type: 'evasion',
          multiplier: 1.5,
          description: '+50% evasion in ethereal form',
        },
      ],
    },
    {
      phaseNumber: 3,
      healthThreshold: 50,
      name: 'The Legion',
      description: 'Sangre summons his undead army.',
      dialogue: '"SOLDIERS! ATTACK!"',
      abilities: ['phase_shift', 'ethereal_ambush', 'summon_legion', 'battle_tactics'],
      modifiers: [
        {
          type: 'damage',
          multiplier: 1.5,
          description: '+50% damage',
        },
      ],
      summonMinions: {
        type: 'ghost_soldier',
        count: 6,
        spawnMessage: 'Ghostly soldiers rise from the ground!',
      },
    },
    {
      phaseNumber: 4,
      healthThreshold: 25,
      name: 'The Blood Rage',
      description: 'Sangre\'s fury reaches its peak.',
      dialogue: '"I WILL NOT BE DENIED! THIS LAND IS MINE!"',
      abilities: ['blood_frenzy', 'death_charge', 'massacre'],
      modifiers: [
        {
          type: 'damage',
          multiplier: 2.5,
          description: '+150% damage',
        },
        {
          type: 'speed',
          multiplier: 1.5,
          description: '+50% attack speed',
        },
      ],
      environmentalHazard: {
        name: 'Blood Rain',
        description: 'Blood falls from the sky',
        damagePerTurn: 50,
        avoidable: false,
      },
    },
  ],

  abilities: [
    {
      id: 'spectral_saber',
      name: 'Spectral Saber',
      description: 'A slash that phases through armor',
      type: BossAbilityType.DAMAGE,
      cooldown: 0,
      damage: 280,
      damageType: BossDamageType.VOID,
      avoidable: false,
      priority: 5,
      targetType: 'single',
    },
    {
      id: 'ghostly_charge',
      name: 'Ghostly Charge',
      description: 'Charges through enemies, damaging all in path',
      type: BossAbilityType.AOE,
      cooldown: 3,
      damage: 350,
      damageType: BossDamageType.PHYSICAL,
      avoidable: true,
      avoidMechanic: 'Step out of the charge path',
      telegraphMessage: 'Sangre prepares to charge!',
      priority: 7,
      targetType: 'all',
    },
    {
      id: 'commanders_presence',
      name: "Commander's Presence",
      description: 'Boosts all ghost soldier damage',
      type: BossAbilityType.BUFF,
      cooldown: 5,
      avoidable: false,
      priority: 6,
      targetType: 'all',
    },
    {
      id: 'phase_shift',
      name: 'Phase Shift',
      description: 'Shifts between physical and ethereal',
      type: BossAbilityType.BUFF,
      cooldown: 4,
      avoidable: false,
      telegraphMessage: 'Sangre becomes incorporeal...',
      priority: 8,
      requiresPhase: 2,
      targetType: 'single',
    },
    {
      id: 'ethereal_ambush',
      name: 'Ethereal Ambush',
      description: 'Attacks from the spirit world',
      type: BossAbilityType.DAMAGE,
      cooldown: 5,
      damage: 420,
      damageType: BossDamageType.VOID,
      avoidable: false,
      telegraphMessage: 'A chill runs down your spine...',
      priority: 9,
      requiresPhase: 2,
      targetType: 'single',
    },
    {
      id: 'summon_legion',
      name: 'Summon Legion',
      description: 'Calls forth ghost soldiers',
      type: BossAbilityType.SUMMON,
      cooldown: 8,
      avoidable: false,
      telegraphMessage: 'The ground trembles with the march of the dead!',
      priority: 7,
      requiresPhase: 3,
      targetType: 'all',
    },
    {
      id: 'battle_tactics',
      name: 'Battle Tactics',
      description: 'Commands coordinated assault',
      type: BossAbilityType.DAMAGE,
      cooldown: 6,
      damage: 500,
      damageType: BossDamageType.PHYSICAL,
      avoidable: true,
      avoidMechanic: 'Disrupt formation',
      telegraphMessage: 'Sangre signals his troops!',
      priority: 8,
      requiresPhase: 3,
      targetType: 'all',
    },
    {
      id: 'blood_frenzy',
      name: 'Blood Frenzy',
      description: 'Attacks wildly with devastating power',
      type: BossAbilityType.DAMAGE,
      cooldown: 2,
      damage: 550,
      damageType: BossDamageType.VOID,
      avoidable: false,
      priority: 9,
      requiresPhase: 4,
      targetType: 'single',
    },
    {
      id: 'death_charge',
      name: 'Death Charge',
      description: 'Ultimate cavalry charge',
      type: BossAbilityType.ULTIMATE,
      cooldown: 7,
      damage: 800,
      damageType: BossDamageType.PHYSICAL,
      avoidable: true,
      avoidMechanic: 'Perfect dodge timing',
      telegraphMessage: 'SANGRE CHARGES!',
      priority: 10,
      requiresPhase: 4,
      targetType: 'all',
    },
    {
      id: 'massacre',
      name: 'Massacre',
      description: 'Devastating assault on all enemies',
      type: BossAbilityType.ULTIMATE,
      cooldown: 10,
      damage: 1000,
      damageType: BossDamageType.VOID,
      avoidable: true,
      avoidMechanic: 'Interrupt the ability',
      telegraphMessage: 'SANGRE SCREAMS FOR BLOOD!',
      priority: 10,
      requiresPhase: 4,
      targetType: 'all',
    },
  ],

  weaknesses: [
    {
      damageType: BossDamageType.DIVINE,
      multiplier: 1.6,
      description: 'Holy weapons harm the restless dead',
    },
    {
      damageType: BossDamageType.FIRE,
      multiplier: 1.3,
      description: 'Fire purifies the spirit',
    },
  ],
  immunities: [BossDamageType.POISON, BossDamageType.FROST],

  specialMechanics: [
    {
      id: 'phase_timing',
      name: 'Phase Timing',
      description: 'Attack during physical phases',
      type: 'unique',
      instructions: 'Watch for phase shifts - can only be damaged in physical form',
      successReward: 'Bonus damage during physical phase',
    },
    {
      id: 'kill_soldiers',
      name: 'Thin the Ranks',
      description: 'Clear ghost soldiers to weaken Sangre',
      type: 'coordination',
      instructions: 'Kill soldiers before they buff Sangre',
      failureConsequence: 'Sangre receives massive damage boost',
    },
  ],

  environmentEffects: [
    {
      id: 'battlefield_ghosts',
      name: 'Echoes of Battle',
      description: 'Ghost soldiers attack periodically',
      triggersAt: 'start',
      effect: {
        type: 'damage',
        target: 'player',
        power: 30,
      },
      duration: undefined,
    },
  ],

  playerLimit: {
    min: 1,
    max: 5,
    recommended: 5,
  },

  scaling: {
    healthPerPlayer: 80,
    damagePerPlayer: 20,
  },

  guaranteedDrops: [
    {
      itemId: 'sangre_saber',
      name: "General Sangre's Spectral Saber",
      rarity: 'mythic',
      quantity: 1,
      guaranteedFirstKill: true,
    },
  ],

  lootTable: [
    {
      itemId: 'ghost_medal',
      name: 'Medal of the Damned',
      description: 'A military medal from beyond the grave',
      rarity: 'legendary',
      dropChance: 0.5,
      minQuantity: 1,
      maxQuantity: 1,
    },
    {
      itemId: 'ectoplasm',
      name: 'Concentrated Ectoplasm',
      description: 'Spiritual essence in physical form',
      rarity: 'epic',
      dropChance: 0.8,
      minQuantity: 3,
      maxQuantity: 7,
    },
  ],

  goldReward: {
    min: 10000,
    max: 18000,
  },
  experienceReward: 32000,

  achievements: ['sangre_defeated', 'ghost_general_slain', 'undead_army_crushed'],
  titles: ['Sangre Slayer', 'Ghost Breaker', 'Legion Crusher'],
  firstKillBonus: {
    title: "Conqueror of Sangre's Shade",
    item: 'sangre_uniform',
    gold: 6000,
  },

  difficulty: 10,
  enrageTimer: 40,
  canFlee: true,
  fleeConsequence: 'Ghost soldiers pursue you across the territory',
};

/**
 * THE TIMELESS COYOTE - Level 48
 * A trickster spirit with power over time
 */
export const THE_TIMELESS_COYOTE: BossEncounter = {
  id: 'boss_timeless_coyote',
  name: 'The Timeless Coyote',
  title: 'Trickster of Ages',
  category: BossCategory.COSMIC_HORROR,
  tier: BossTier.MYTHIC,
  level: 48,

  description: 'A massive coyote spirit that exists outside of time. It can rewind moments, freeze instants, and age enemies to dust.',
  backstory: 'Before the world was, Coyote played. It wove time like thread, creating and destroying at whim. When the cosmic disturbance awakened the old powers, Coyote began to play again - and mortals are its toys.',
  defeatDialogue: '*It laughs - a sound that echoes across centuries.* "Good game! I\'ll see you yesterday. Or tomorrow. Time is a circle, little meat. We\'ll play again."',
  victoryNarrative: 'The Timeless Coyote vanishes with a grin and a wink. You\'re not sure if you won, or if it simply got bored. With tricksters, there\'s never a clear answer.',

  location: 'The Temporal Badlands',
  spawnConditions: [
    {
      type: BossSpawnConditionType.LEVEL,
      value: 48,
      description: 'Must be level 48 or higher',
    },
    {
      type: BossSpawnConditionType.QUEST,
      value: 2,
      description: 'Must have prestiged at least twice',
    },
  ],
  respawnCooldown: 168,

  health: 38000,
  damage: 350,
  defense: 110,
  criticalChance: 0.30,
  evasion: 0.40,

  phases: [
    {
      phaseNumber: 1,
      healthThreshold: 100,
      name: 'The Game Begins',
      description: 'Coyote sizes up its new playmates.',
      dialogue: '"Ohoho! Fresh meat! Let\'s PLAY!"',
      abilities: ['temporal_bite', 'time_slip', 'echo_strike'],
      modifiers: [],
    },
    {
      phaseNumber: 2,
      healthThreshold: 75,
      name: 'Tricks of Time',
      description: 'Coyote starts manipulating time itself.',
      dialogue: '"Too slow! Try again - oh wait, you CAN\'T!"',
      abilities: ['time_slip', 'echo_strike', 'rewind_wound', 'time_loop'],
      modifiers: [
        {
          type: 'speed',
          multiplier: 1.5,
          description: '+50% speed from time manipulation',
        },
      ],
    },
    {
      phaseNumber: 3,
      healthThreshold: 50,
      name: 'The Joke',
      description: 'Coyote finds the whole thing hilarious.',
      dialogue: '"THIS IS SO FUN! Let me show you my BEST trick!"',
      abilities: ['time_loop', 'age_acceleration', 'paradox_burst', 'summon_past_selves'],
      modifiers: [
        {
          type: 'damage',
          multiplier: 1.6,
          description: '+60% damage',
        },
      ],
      summonMinions: {
        type: 'temporal_echo',
        count: 3,
        spawnMessage: 'Past versions of the Coyote appear!',
      },
    },
    {
      phaseNumber: 4,
      healthThreshold: 25,
      name: 'The Punchline',
      description: 'Coyote reveals its full temporal power.',
      dialogue: '"Time to end this. Get it? TIME? AHAHAHA!"',
      abilities: ['paradox_burst', 'entropy_wave', 'temporal_annihilation'],
      modifiers: [
        {
          type: 'damage',
          multiplier: 2.2,
          description: '+120% damage',
        },
        {
          type: 'speed',
          multiplier: 2.0,
          description: '+100% speed',
        },
      ],
      environmentalHazard: {
        name: 'Time Storm',
        description: 'Time itself is breaking down',
        damagePerTurn: 60,
        avoidable: false,
      },
    },
  ],

  abilities: [
    {
      id: 'temporal_bite',
      name: 'Temporal Bite',
      description: 'Bites across multiple moments simultaneously',
      type: BossAbilityType.DAMAGE,
      cooldown: 0,
      damage: 300,
      damageType: BossDamageType.REALITY,
      avoidable: false,
      priority: 5,
      targetType: 'single',
    },
    {
      id: 'time_slip',
      name: 'Time Slip',
      description: 'Dodges by slipping through time',
      type: BossAbilityType.BUFF,
      cooldown: 3,
      avoidable: false,
      telegraphMessage: 'The Coyote flickers through time...',
      priority: 6,
      targetType: 'single',
    },
    {
      id: 'echo_strike',
      name: 'Echo Strike',
      description: 'Attacks from past and future simultaneously',
      type: BossAbilityType.DAMAGE,
      cooldown: 2,
      damage: 200,
      damageType: BossDamageType.REALITY,
      avoidable: true,
      avoidMechanic: 'Dodge both temporal echoes',
      telegraphMessage: 'You see afterimages of the attack...',
      priority: 7,
      targetType: 'single',
    },
    {
      id: 'rewind_wound',
      name: 'Rewind Wound',
      description: 'Rewinds time to undo healing',
      type: BossAbilityType.DEBUFF,
      cooldown: 5,
      damage: 0,
      damageType: BossDamageType.REALITY,
      effect: {
        type: StatusEffect.BLEED,
        duration: 5,
        power: 60,
        stackable: true,
        maxStacks: 3,
        appliedAt: new Date(),
      },
      avoidable: false,
      priority: 8,
      requiresPhase: 2,
      targetType: 'single',
    },
    {
      id: 'time_loop',
      name: 'Time Loop',
      description: 'Traps target in a repeating moment',
      type: BossAbilityType.DEBUFF,
      cooldown: 6,
      damage: 150,
      damageType: BossDamageType.REALITY,
      effect: {
        type: StatusEffect.STUN,
        duration: 3,
        power: 80,
        stackable: false,
        appliedAt: new Date(),
      },
      avoidable: true,
      avoidMechanic: 'Break free with strong will',
      telegraphMessage: 'Time begins to loop around you!',
      priority: 9,
      requiresPhase: 2,
      targetType: 'single',
    },
    {
      id: 'age_acceleration',
      name: 'Age Acceleration',
      description: 'Rapidly ages the target',
      type: BossAbilityType.DOT,
      cooldown: 7,
      damage: 100,
      damageType: BossDamageType.REALITY,
      effect: {
        type: StatusEffect.WEAKNESS,
        duration: 6,
        power: 40,
        stackable: true,
        maxStacks: 5,
        appliedAt: new Date(),
      },
      avoidable: false,
      telegraphMessage: 'You feel the years passing...',
      priority: 8,
      requiresPhase: 3,
      targetType: 'single',
    },
    {
      id: 'paradox_burst',
      name: 'Paradox Burst',
      description: 'Causes a temporal paradox explosion',
      type: BossAbilityType.AOE,
      cooldown: 5,
      damage: 550,
      damageType: BossDamageType.REALITY,
      avoidable: true,
      avoidMechanic: 'Escape the paradox zone',
      telegraphMessage: 'PARADOX IMMINENT!',
      priority: 9,
      requiresPhase: 3,
      targetType: 'all',
    },
    {
      id: 'summon_past_selves',
      name: 'Summon Past Selves',
      description: 'Brings versions from other times',
      type: BossAbilityType.SUMMON,
      cooldown: 8,
      avoidable: false,
      telegraphMessage: 'Past and future converge!',
      priority: 7,
      requiresPhase: 3,
      targetType: 'all',
    },
    {
      id: 'entropy_wave',
      name: 'Entropy Wave',
      description: 'Accelerates entropy across the battlefield',
      type: BossAbilityType.AOE,
      cooldown: 6,
      damage: 650,
      damageType: BossDamageType.VOID,
      avoidable: false,
      telegraphMessage: 'Everything is aging rapidly!',
      priority: 10,
      requiresPhase: 4,
      targetType: 'all',
    },
    {
      id: 'temporal_annihilation',
      name: 'Temporal Annihilation',
      description: 'Erases target from the timeline',
      type: BossAbilityType.ULTIMATE,
      cooldown: 10,
      damage: 1200,
      damageType: BossDamageType.REALITY,
      avoidable: true,
      avoidMechanic: 'Kill the Coyote before cast completes',
      telegraphMessage: 'THE COYOTE IS ERASING YOU FROM TIME!',
      priority: 10,
      requiresPhase: 4,
      targetType: 'single',
    },
  ],

  weaknesses: [
    {
      damageType: BossDamageType.DIVINE,
      multiplier: 1.4,
      description: 'Divine power transcends time',
    },
  ],
  immunities: [BossDamageType.PHYSICAL, BossDamageType.POISON],

  specialMechanics: [
    {
      id: 'time_anchors',
      name: 'Temporal Anchors',
      description: 'Stay anchored in the present',
      type: 'puzzle',
      instructions: 'Maintain time anchors to avoid being erased',
      successReward: 'Immunity to time manipulation',
      failureConsequence: 'Massive damage and debuffs',
    },
    {
      id: 'echo_management',
      name: 'Echo Management',
      description: 'Kill temporal echoes before they merge',
      type: 'coordination',
      instructions: 'Destroy all echoes within 30 seconds',
      failureConsequence: 'Coyote heals and gains damage',
    },
  ],

  environmentEffects: [
    {
      id: 'time_flux',
      name: 'Time Flux',
      description: 'Time flows unpredictably',
      triggersAt: 'start',
      effect: {
        type: 'damage',
        target: 'player',
        power: 35,
      },
      duration: undefined,
    },
  ],

  playerLimit: {
    min: 1,
    max: 5,
    recommended: 5,
  },

  scaling: {
    healthPerPlayer: 85,
    damagePerPlayer: 22,
  },

  guaranteedDrops: [
    {
      itemId: 'coyote_hourglass',
      name: 'Hourglass of the Trickster',
      rarity: 'mythic',
      quantity: 1,
      guaranteedFirstKill: true,
    },
  ],

  lootTable: [
    {
      itemId: 'frozen_moment',
      name: 'Frozen Moment',
      description: 'A captured instant of time',
      rarity: 'legendary',
      dropChance: 0.5,
      minQuantity: 1,
      maxQuantity: 2,
    },
    {
      itemId: 'temporal_dust',
      name: 'Temporal Dust',
      description: 'Sand from the hourglass of existence',
      rarity: 'epic',
      dropChance: 0.8,
      minQuantity: 4,
      maxQuantity: 8,
    },
  ],

  goldReward: {
    min: 12000,
    max: 22000,
  },
  experienceReward: 40000,

  achievements: ['trickster_bested', 'time_survivor', 'paradox_resolver'],
  titles: ['Trickster Bane', 'Time-Walker', 'Paradox Breaker'],
  firstKillBonus: {
    title: 'The One Who Outplayed the Trickster',
    item: 'coyote_mask',
    gold: 8000,
  },

  difficulty: 10,
  enrageTimer: 45,
  canFlee: false,
  fleeConsequence: 'Time loops eternally - you can never leave',
};

/**
 * PARTIAL MANIFESTATION - Level 49
 * A partial awakening of What-Waits-Below
 */
export const PARTIAL_MANIFESTATION: BossEncounter = {
  id: 'boss_partial_manifestation',
  name: 'Partial Manifestation',
  title: 'Echo of What-Waits-Below',
  category: BossCategory.ULTIMATE,
  tier: BossTier.ULTIMATE,
  level: 49,

  description: 'A fragment of the entity beneath The Scar, forced partially into physical form. Reality screams at its presence. Sanity cracks like glass.',
  backstory: 'Through the cracks in The Scar, something reaches. Not the full entity - even a fraction of that power would unmake the world. But this partial manifestation is enough. More than enough.',
  defeatDialogue: '*It withdraws, but not from defeat. From PATIENCE. It has waited millennia. It can wait a few more moments.*',
  victoryNarrative: 'The manifestation recedes into The Scar. You feel, rather than hear, something in the deep places of the world: "Soon."',

  location: 'Edge of The Scar',
  spawnConditions: [
    {
      type: BossSpawnConditionType.LEVEL,
      value: 49,
      description: 'Must be level 49 or higher',
    },
    {
      type: BossSpawnConditionType.QUEST,
      value: 3,
      description: 'Must have prestiged at least three times',
    },
    {
      type: BossSpawnConditionType.QUEST,
      value: 'cosmic_quest_finale_preparation',
      description: 'Must be preparing for the final cosmic encounter',
    },
  ],
  respawnCooldown: 336, // 2 weeks

  health: 45000,
  damage: 400,
  defense: 130,
  criticalChance: 0.30,
  evasion: 0.25,

  phases: [
    {
      phaseNumber: 1,
      healthThreshold: 100,
      name: 'The Glimpse',
      description: 'You glimpse something that should not be seen.',
      dialogue: '*There are no words. Only a pressure in your skull that might have been a greeting.*',
      abilities: ['void_touch', 'madness_wave', 'reality_tear'],
      modifiers: [],
    },
    {
      phaseNumber: 2,
      healthThreshold: 75,
      name: 'The Reaching',
      description: 'It reaches further into our world.',
      dialogue: '*More of it pushes through. The air tastes like copper and starlight.*',
      abilities: ['madness_wave', 'reality_tear', 'sanity_shatter', 'summon_fragments'],
      modifiers: [
        {
          type: 'damage',
          multiplier: 1.4,
          description: '+40% damage',
        },
      ],
      summonMinions: {
        type: 'reality_fragment',
        count: 5,
        spawnMessage: 'Pieces of corrupted reality manifest!',
      },
    },
    {
      phaseNumber: 3,
      healthThreshold: 50,
      name: 'The Grasping',
      description: 'It tries to pull itself fully through.',
      dialogue: '*The world SCREAMS*',
      abilities: ['sanity_shatter', 'existence_denial', 'void_cascade', 'reality_consumption'],
      modifiers: [
        {
          type: 'damage',
          multiplier: 1.8,
          description: '+80% damage',
        },
      ],
      environmentalHazard: {
        name: 'Cosmic Corruption',
        description: 'Reality is breaking down',
        damagePerTurn: 80,
        avoidable: false,
      },
    },
    {
      phaseNumber: 4,
      healthThreshold: 25,
      name: 'The Partial Truth',
      description: 'You see a fraction of what it truly is.',
      dialogue: '*Your mind BREAKS. This is mercy - full understanding would destroy you.*',
      abilities: ['reality_consumption', 'apocalypse_preview', 'oblivion_touch'],
      modifiers: [
        {
          type: 'damage',
          multiplier: 2.5,
          description: '+150% damage',
        },
      ],
      environmentalHazard: {
        name: 'End of All Things',
        description: 'Existence itself begins to fail',
        damagePerTurn: 150,
        avoidable: false,
      },
    },
  ],

  abilities: [
    {
      id: 'void_touch',
      name: 'Void Touch',
      description: 'A brush with nothingness',
      type: BossAbilityType.DAMAGE,
      cooldown: 0,
      damage: 350,
      damageType: BossDamageType.VOID,
      avoidable: false,
      priority: 5,
      targetType: 'single',
    },
    {
      id: 'madness_wave',
      name: 'Madness Wave',
      description: 'Incomprehensible knowledge floods your mind',
      type: BossAbilityType.DOT,
      cooldown: 3,
      damage: 0,
      damageType: BossDamageType.PSYCHIC,
      effect: {
        type: StatusEffect.MADNESS,
        duration: 8,
        power: 80,
        stackable: true,
        maxStacks: 10,
        appliedAt: new Date(),
      },
      avoidable: false,
      priority: 8,
      targetType: 'all',
    },
    {
      id: 'reality_tear',
      name: 'Reality Tear',
      description: 'Rips holes in existence',
      type: BossAbilityType.AOE,
      cooldown: 4,
      damage: 450,
      damageType: BossDamageType.REALITY,
      avoidable: true,
      avoidMechanic: 'Avoid the tears',
      telegraphMessage: 'Reality is tearing apart!',
      priority: 7,
      targetType: 'all',
    },
    {
      id: 'sanity_shatter',
      name: 'Sanity Shatter',
      description: 'Completely breaks the mind',
      type: BossAbilityType.DEBUFF,
      cooldown: 6,
      damage: 200,
      damageType: BossDamageType.PSYCHIC,
      effect: {
        type: StatusEffect.CONFUSION,
        duration: 5,
        power: 100,
        stackable: false,
        appliedAt: new Date(),
      },
      avoidable: true,
      avoidMechanic: 'Mental fortitude saves',
      telegraphMessage: 'Your sanity cracks...',
      priority: 9,
      requiresPhase: 2,
      targetType: 'single',
    },
    {
      id: 'summon_fragments',
      name: 'Summon Fragments',
      description: 'Calls pieces of corrupted reality',
      type: BossAbilityType.SUMMON,
      cooldown: 8,
      avoidable: false,
      telegraphMessage: 'Reality shatters into hostile fragments!',
      priority: 7,
      requiresPhase: 2,
      targetType: 'all',
    },
    {
      id: 'existence_denial',
      name: 'Existence Denial',
      description: 'Temporarily erases target from reality',
      type: BossAbilityType.DEBUFF,
      cooldown: 7,
      damage: 500,
      damageType: BossDamageType.VOID,
      effect: {
        type: StatusEffect.ROOT,
        duration: 4,
        power: 100,
        stackable: false,
        appliedAt: new Date(),
      },
      avoidable: false,
      telegraphMessage: 'You begin to fade from existence!',
      priority: 10,
      requiresPhase: 3,
      targetType: 'single',
    },
    {
      id: 'void_cascade',
      name: 'Void Cascade',
      description: 'Waves of nothingness sweep the area',
      type: BossAbilityType.AOE,
      cooldown: 5,
      damage: 600,
      damageType: BossDamageType.VOID,
      avoidable: true,
      avoidMechanic: 'Find safe zones',
      telegraphMessage: 'The void cascades outward!',
      priority: 9,
      requiresPhase: 3,
      targetType: 'all',
    },
    {
      id: 'reality_consumption',
      name: 'Reality Consumption',
      description: 'Consumes chunks of reality',
      type: BossAbilityType.ULTIMATE,
      cooldown: 8,
      damage: 800,
      damageType: BossDamageType.REALITY,
      avoidable: false,
      telegraphMessage: 'REALITY IS BEING CONSUMED',
      priority: 10,
      requiresPhase: 3,
      targetType: 'all',
    },
    {
      id: 'apocalypse_preview',
      name: 'Apocalypse Preview',
      description: 'Shows the end of everything',
      type: BossAbilityType.ULTIMATE,
      cooldown: 7,
      damage: 1000,
      damageType: BossDamageType.CORRUPTION,
      avoidable: false,
      telegraphMessage: 'YOU SEE THE END',
      priority: 10,
      requiresPhase: 4,
      targetType: 'all',
    },
    {
      id: 'oblivion_touch',
      name: 'Touch of Oblivion',
      description: 'Final erasure',
      type: BossAbilityType.ULTIMATE,
      cooldown: 12,
      damage: 2000,
      damageType: BossDamageType.VOID,
      avoidable: true,
      avoidMechanic: 'Defeat it before cast completes',
      telegraphMessage: 'OBLIVION REACHES FOR YOU',
      priority: 10,
      requiresPhase: 4,
      targetType: 'single',
    },
  ],

  weaknesses: [
    {
      damageType: BossDamageType.DIVINE,
      multiplier: 1.8,
      description: 'Sacred power is the only effective weapon',
    },
  ],
  immunities: [BossDamageType.PHYSICAL, BossDamageType.POISON, BossDamageType.FROST, BossDamageType.PSYCHIC],

  specialMechanics: [
    {
      id: 'sanity_management',
      name: 'Sanity Management',
      description: 'Keep sanity above zero or be lost',
      type: 'unique',
      instructions: 'Use sanity restoratives constantly',
      failureConsequence: 'Permanent madness and death',
    },
    {
      id: 'reality_anchors',
      name: 'Reality Anchors',
      description: 'Maintain anchors to survive',
      type: 'coordination',
      instructions: 'All players must maintain anchors',
      failureConsequence: 'Instant wipe from reality collapse',
    },
  ],

  environmentEffects: [
    {
      id: 'scar_proximity',
      name: 'Proximity to The Scar',
      description: 'Being near The Scar corrupts you',
      triggersAt: 'start',
      effect: {
        type: 'damage',
        target: 'player',
        power: 45,
      },
      duration: undefined,
    },
  ],

  playerLimit: {
    min: 3,
    max: 8,
    recommended: 6,
  },

  scaling: {
    healthPerPlayer: 90,
    damagePerPlayer: 25,
  },

  guaranteedDrops: [
    {
      itemId: 'fragment_of_below',
      name: 'Fragment of What-Waits-Below',
      rarity: 'mythic',
      quantity: 1,
      guaranteedFirstKill: true,
    },
  ],

  lootTable: [
    {
      itemId: 'void_crystal',
      name: 'Crystal of the Void',
      description: 'Solidified nothingness',
      rarity: 'legendary',
      dropChance: 0.6,
      minQuantity: 2,
      maxQuantity: 4,
    },
    {
      itemId: 'madness_essence',
      name: 'Essence of Madness',
      description: 'Concentrated insanity',
      rarity: 'epic',
      dropChance: 0.9,
      minQuantity: 5,
      maxQuantity: 10,
    },
  ],

  goldReward: {
    min: 15000,
    max: 30000,
  },
  experienceReward: 45000,

  achievements: ['manifestation_repelled', 'void_survivor', 'sanity_intact'],
  titles: ['Void Repeller', 'Sanity Keeper', 'Reality Anchor'],
  firstKillBonus: {
    title: 'The One Who Glimpsed The Truth',
    item: 'eye_of_below',
    gold: 10000,
  },

  difficulty: 10,
  enrageTimer: 50,
  canFlee: false,
  fleeConsequence: 'It follows. It always follows.',
};

/**
 * THE COSMIC TRUTH - Level 50
 * The final prestige boss - reveals the ultimate nature of the cosmic threat
 */
export const THE_COSMIC_TRUTH: BossEncounter = {
  id: 'boss_cosmic_truth',
  name: 'The Cosmic Truth',
  title: 'The Final Revelation',
  category: BossCategory.ULTIMATE,
  tier: BossTier.ULTIMATE,
  level: 50,

  description: 'Not an enemy, but the final understanding. You face not a creature but the horrifying reality of the universe itself. This is the ultimate test for those who would achieve Mythic prestige.',
  backstory: 'All the horrors, all the cosmic entities, all the reality tears - they were symptoms. Now you face the cause. The Cosmic Truth is the revelation of what the universe truly is, and why beings like What-Waits-Below exist. Facing it means facing oblivion, transcendence, or something stranger than either.',
  defeatDialogue: '"You have understood. You have accepted. You have transcended. Now, you ARE."',
  victoryNarrative: 'The truth settles into your mind. You understand now - everything. The weight is immense, but you bear it. You have become something more than mortal. Something that can stand between the cosmos and the world.',

  location: 'Heart of Reality',
  spawnConditions: [
    {
      type: BossSpawnConditionType.LEVEL,
      value: 50,
      description: 'Must be level 50',
    },
    {
      type: BossSpawnConditionType.QUEST,
      value: 4,
      description: 'Must have prestiged at least four times',
    },
    {
      type: BossSpawnConditionType.QUEST,
      value: 'cosmic_truth_revelation',
      description: 'Must have completed all cosmic preparations',
    },
  ],
  respawnCooldown: 720, // 30 days

  health: 60000,
  damage: 500,
  defense: 150,
  criticalChance: 0.35,
  evasion: 0.30,

  phases: [
    {
      phaseNumber: 1,
      healthThreshold: 100,
      name: 'The Question',
      description: 'It asks you: What do you believe reality is?',
      dialogue: '*The question echoes through every atom of your being*',
      abilities: ['existential_strike', 'doubt_wave', 'reality_question'],
      modifiers: [],
    },
    {
      phaseNumber: 2,
      healthThreshold: 80,
      name: 'The Answer',
      description: 'It shows you the truth of existence.',
      dialogue: '*You see. You understand. You SCREAM.*',
      abilities: ['truth_revelation', 'cosmic_horror', 'existence_rewrite'],
      modifiers: [
        {
          type: 'damage',
          multiplier: 1.5,
          description: '+50% damage',
        },
      ],
    },
    {
      phaseNumber: 3,
      healthThreshold: 60,
      name: 'The Acceptance',
      description: 'You must accept what you\'ve learned.',
      dialogue: '*Can you bear the weight of truth?*',
      abilities: ['truth_revelation', 'cosmic_horror', 'existence_rewrite', 'acceptance_test', 'summon_truths'],
      modifiers: [
        {
          type: 'damage',
          multiplier: 1.8,
          description: '+80% damage',
        },
      ],
      summonMinions: {
        type: 'aspect_of_truth',
        count: 4,
        spawnMessage: 'Aspects of cosmic truth manifest!',
      },
    },
    {
      phaseNumber: 4,
      healthThreshold: 40,
      name: 'The Struggle',
      description: 'You fight against the overwhelming truth.',
      dialogue: '*ACCEPT. OR. PERISH.*',
      abilities: ['acceptance_test', 'oblivion_truth', 'final_revelation'],
      modifiers: [
        {
          type: 'damage',
          multiplier: 2.2,
          description: '+120% damage',
        },
      ],
      environmentalHazard: {
        name: 'Weight of Truth',
        description: 'The truth crushes you',
        damagePerTurn: 100,
        avoidable: false,
      },
    },
    {
      phaseNumber: 5,
      healthThreshold: 20,
      name: 'The Transcendence',
      description: 'You transcend mortal understanding.',
      dialogue: '*You are becoming something NEW*',
      abilities: ['final_revelation', 'cosmic_rebirth', 'ultimate_truth'],
      modifiers: [
        {
          type: 'damage',
          multiplier: 3.0,
          description: '+200% damage',
        },
      ],
    },
  ],

  abilities: [
    {
      id: 'existential_strike',
      name: 'Existential Strike',
      description: 'Questions your very existence',
      type: BossAbilityType.DAMAGE,
      cooldown: 0,
      damage: 400,
      damageType: BossDamageType.REALITY,
      avoidable: false,
      priority: 5,
      targetType: 'single',
    },
    {
      id: 'doubt_wave',
      name: 'Wave of Doubt',
      description: 'Makes you question everything',
      type: BossAbilityType.DEBUFF,
      cooldown: 3,
      damage: 0,
      damageType: BossDamageType.PSYCHIC,
      effect: {
        type: StatusEffect.WEAKNESS,
        duration: 5,
        power: 50,
        stackable: true,
        maxStacks: 5,
        appliedAt: new Date(),
      },
      avoidable: false,
      priority: 7,
      targetType: 'all',
    },
    {
      id: 'reality_question',
      name: 'Question Reality',
      description: 'Forces you to confront what is real',
      type: BossAbilityType.DEBUFF,
      cooldown: 5,
      damage: 300,
      damageType: BossDamageType.PSYCHIC,
      effect: {
        type: StatusEffect.CONFUSION,
        duration: 4,
        power: 70,
        stackable: false,
        appliedAt: new Date(),
      },
      avoidable: true,
      avoidMechanic: 'Mental fortitude',
      priority: 8,
      targetType: 'single',
    },
    {
      id: 'truth_revelation',
      name: 'Truth Revelation',
      description: 'Shows you cosmic truth',
      type: BossAbilityType.DOT,
      cooldown: 4,
      damage: 0,
      damageType: BossDamageType.VOID,
      effect: {
        type: StatusEffect.MADNESS,
        duration: 10,
        power: 100,
        stackable: true,
        maxStacks: 99,
        appliedAt: new Date(),
      },
      avoidable: false,
      priority: 9,
      requiresPhase: 2,
      targetType: 'all',
    },
    {
      id: 'cosmic_horror',
      name: 'Cosmic Horror',
      description: 'The full weight of understanding',
      type: BossAbilityType.AOE,
      cooldown: 5,
      damage: 600,
      damageType: BossDamageType.CORRUPTION,
      avoidable: false,
      telegraphMessage: 'THE HORROR OF TRUTH!',
      priority: 10,
      requiresPhase: 2,
      targetType: 'all',
    },
    {
      id: 'existence_rewrite',
      name: 'Existence Rewrite',
      description: 'Rewrites your reality',
      type: BossAbilityType.DAMAGE,
      cooldown: 6,
      damage: 700,
      damageType: BossDamageType.REALITY,
      avoidable: true,
      avoidMechanic: 'Anchor your identity',
      telegraphMessage: 'Your existence is being rewritten!',
      priority: 9,
      requiresPhase: 2,
      targetType: 'single',
    },
    {
      id: 'acceptance_test',
      name: 'Test of Acceptance',
      description: 'Can you accept the truth?',
      type: BossAbilityType.ULTIMATE,
      cooldown: 8,
      damage: 1000,
      damageType: BossDamageType.VOID,
      avoidable: true,
      avoidMechanic: 'Accept the truth to survive',
      telegraphMessage: 'ACCEPT OR PERISH',
      priority: 10,
      requiresPhase: 3,
      targetType: 'all',
    },
    {
      id: 'summon_truths',
      name: 'Summon Aspects of Truth',
      description: 'Calls forth aspects of cosmic truth',
      type: BossAbilityType.SUMMON,
      cooldown: 10,
      avoidable: false,
      telegraphMessage: 'Truth manifests in multiple forms!',
      priority: 8,
      requiresPhase: 3,
      targetType: 'all',
    },
    {
      id: 'oblivion_truth',
      name: 'Truth of Oblivion',
      description: 'The truth that existence ends',
      type: BossAbilityType.ULTIMATE,
      cooldown: 7,
      damage: 1200,
      damageType: BossDamageType.VOID,
      avoidable: false,
      telegraphMessage: 'ALL ENDS',
      priority: 10,
      requiresPhase: 4,
      targetType: 'all',
    },
    {
      id: 'final_revelation',
      name: 'Final Revelation',
      description: 'The ultimate truth',
      type: BossAbilityType.ULTIMATE,
      cooldown: 10,
      damage: 1500,
      damageType: BossDamageType.REALITY,
      avoidable: true,
      avoidMechanic: 'Complete understanding to transcend',
      telegraphMessage: 'THE FINAL TRUTH REVEALS ITSELF',
      priority: 10,
      requiresPhase: 4,
      targetType: 'all',
    },
    {
      id: 'cosmic_rebirth',
      name: 'Cosmic Rebirth',
      description: 'Die and be reborn in truth',
      type: BossAbilityType.DAMAGE,
      cooldown: 5,
      damage: 800,
      damageType: BossDamageType.DIVINE,
      avoidable: false,
      telegraphMessage: 'REBIRTH APPROACHES',
      priority: 9,
      requiresPhase: 5,
      targetType: 'all',
    },
    {
      id: 'ultimate_truth',
      name: 'Ultimate Truth',
      description: 'The absolute truth of all existence',
      type: BossAbilityType.ULTIMATE,
      cooldown: 15,
      damage: 9999,
      damageType: BossDamageType.REALITY,
      avoidable: true,
      avoidMechanic: 'Achieve transcendence before it completes',
      telegraphMessage: 'THE ULTIMATE TRUTH IS UPON YOU',
      priority: 10,
      requiresPhase: 5,
      targetType: 'all',
    },
  ],

  weaknesses: [],
  immunities: [BossDamageType.PHYSICAL, BossDamageType.POISON, BossDamageType.FROST],

  specialMechanics: [
    {
      id: 'acceptance_mechanic',
      name: 'Accept the Truth',
      description: 'You must accept cosmic truth to survive',
      type: 'unique',
      instructions: 'Build acceptance through understanding phases',
      successReward: 'Transcendence and Mythic prestige unlock',
      failureConsequence: 'Oblivion - permanent character wipe',
    },
    {
      id: 'sanity_transcendence',
      name: 'Sanity Through Madness',
      description: 'Reach maximum madness then recover',
      type: 'puzzle',
      instructions: 'Let madness max out, then use the Truth Crystal to transcend',
      successReward: 'Immune to all psychic damage',
    },
    {
      id: 'final_choice',
      name: 'The Final Choice',
      description: 'Choose your cosmic fate',
      type: 'unique',
      instructions: 'At the end, choose: Transcend, Return, or Become',
      successReward: 'Different rewards based on choice',
    },
  ],

  environmentEffects: [
    {
      id: 'truth_pressure',
      name: 'Weight of Truth',
      description: 'The truth is overwhelming',
      triggersAt: 'start',
      effect: {
        type: 'damage',
        target: 'player',
        power: 60,
      },
      duration: undefined,
    },
  ],

  playerLimit: {
    min: 5,
    max: 10,
    recommended: 8,
  },

  scaling: {
    healthPerPlayer: 100,
    damagePerPlayer: 30,
  },

  guaranteedDrops: [
    {
      itemId: 'cosmic_truth_crystal',
      name: 'Crystal of Cosmic Truth',
      rarity: 'mythic',
      quantity: 1,
      guaranteedFirstKill: true,
    },
  ],

  lootTable: [
    {
      itemId: 'transcendence_essence',
      name: 'Essence of Transcendence',
      description: 'The power to become more',
      rarity: 'mythic',
      dropChance: 0.8,
      minQuantity: 3,
      maxQuantity: 5,
    },
    {
      itemId: 'reality_core',
      name: 'Core of Reality',
      description: 'A fragment of existence itself',
      rarity: 'legendary',
      dropChance: 1.0,
      minQuantity: 5,
      maxQuantity: 10,
    },
  ],

  goldReward: {
    min: 25000,
    max: 50000,
  },
  experienceReward: 75000,

  achievements: ['truth_achieved', 'transcended', 'mythic_ascension', 'cosmic_understanding'],
  titles: ['Truth Bearer', 'The Transcended', 'Mythic Outlaw', 'Cosmic Sage'],
  firstKillBonus: {
    title: 'The One Who Learned The Truth',
    item: 'mantle_of_truth',
    gold: 25000,
  },

  difficulty: 10,
  enrageTimer: 60,
  canFlee: false,
  fleeConsequence: 'There is no fleeing from truth',
};

/**
 * Export all endgame bosses
 */
export const ENDGAME_BOSSES: BossEncounter[] = [
  THE_COSMIC_SERPENT,
  GENERAL_SANGRES_SHADE,
  THE_TIMELESS_COYOTE,
  PARTIAL_MANIFESTATION,
  THE_COSMIC_TRUTH,
];
