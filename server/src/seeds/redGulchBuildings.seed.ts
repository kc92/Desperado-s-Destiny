/**
 * Red Gulch Buildings Seed Data
 *
 * Seeds the database with 17 buildings for Red Gulch,
 * a Tier 3 Settler Alliance mining town transformed into
 * a bustling frontier commerce hub with social stratification:
 * - Upper Town (elite establishments)
 * - Main Street (8 original buildings, enhanced)
 * - Lower Town (working class)
 * - Chinese Quarter (hidden, unlockable)
 */

import mongoose from 'mongoose';
import logger from '../utils/logger';
import { Location } from '../models/Location.model';
import { LOCATION_IDS } from './locations.seed';

// Building IDs for Red Gulch - Main Street (Original 8)
export const RED_GULCH_BUILDING_IDS = {
  // Main Street (Original 8)
  GOLDEN_SPUR_SALOON: new mongoose.Types.ObjectId('6502b0000000000000000001'),
  SHERIFFS_OFFICE: new mongoose.Types.ObjectId('6502b0000000000000000002'),
  MINERS_SUPPLY: new mongoose.Types.ObjectId('6502b0000000000000000003'),
  RED_GULCH_BANK: new mongoose.Types.ObjectId('6502b0000000000000000004'),
  IRON_JAKES_FORGE: new mongoose.Types.ObjectId('6502b0000000000000000005'),
  GULCH_ASSAY_OFFICE: new mongoose.Types.ObjectId('6502b0000000000000000006'),
  DOC_MORRISONS: new mongoose.Types.ObjectId('6502b0000000000000000007'),
  DUSTY_TRAILS_HOTEL: new mongoose.Types.ObjectId('6502b0000000000000000008'),
  // Upper Town (3 new)
  GOVERNORS_MANSION: new mongoose.Types.ObjectId('6502b0000000000000000009'),
  ASHFORD_MINING_HQ: new mongoose.Types.ObjectId('6502b000000000000000000a'),
  GILDED_PEACOCK: new mongoose.Types.ObjectId('6502b000000000000000000b'),
  // Lower Town (3 new)
  LABOR_EXCHANGE: new mongoose.Types.ObjectId('6502b000000000000000000c'),
  SLOP_HOUSE: new mongoose.Types.ObjectId('6502b000000000000000000d'),
  TENT_CITY: new mongoose.Types.ObjectId('6502b000000000000000000e'),
  // Chinese Quarter (3 new)
  CHENS_APOTHECARY: new mongoose.Types.ObjectId('6502b000000000000000000f'),
  DRAGON_GATE_TEA_HOUSE: new mongoose.Types.ObjectId('6502b0000000000000000010'),
  MEI_LINGS_LAUNDRY: new mongoose.Types.ObjectId('6502b0000000000000000011'),
};

const redGulchBuildings = [
  // =========================================================
  // MAIN STREET - ENHANCED ORIGINAL 8 BUILDINGS
  // =========================================================

  // ===== 1. THE GOLDEN SPUR SALOON (Enhanced) =====
  {
    _id: RED_GULCH_BUILDING_IDS.GOLDEN_SPUR_SALOON,
    name: 'The Golden Spur Saloon',
    description: 'The most popular watering hole in Red Gulch, where miners spend their hard-earned gold on whiskey and cards. The piano plays from dusk till dawn, and rumors flow as freely as the drinks. Dancing Jenny\'s evening performances draw crowds from across the territory.',
    shortDescription: 'Premier saloon with gambling, entertainment, and gossip',
    type: 'saloon',
    region: 'town',
    parentId: LOCATION_IDS.RED_GULCH,
    tier: 3,
    dominantFaction: 'settler',
    operatingHours: { open: 10, close: 4 },
    atmosphere: 'Tobacco smoke hangs thick in the air. The piano player pounds out a lively tune while miners crowd the bar. Card games at the back tables draw high rollers and desperate gamblers alike. The smell of Old Chen\'s cooking drifts from the kitchen, mixing with whiskey and sawdust.',
    npcs: [
      {
        id: 'whiskey-pete',
        name: 'Whiskey Pete',
        title: 'Barkeep',
        description: 'A grizzled old-timer with a handlebar mustache and a talent for mixing drinks. He hears everything but says little. Been tending bar in Red Gulch for twenty years.',
        personality: 'Gruff but fair. Keeps secrets for the right price. Fiercely protective of his regulars.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'What\'ll it be, stranger?',
          'Keep your gun holstered in my saloon.',
          'Heard some interesting talk last night... might be worth your while.',
          'Old Chen makes the best stew west of the Mississippi. Don\'t tell him I said so.',
        ],
      },
      {
        id: 'lucky-lou',
        name: 'Lucky Lou',
        title: 'Card Dealer',
        description: 'A slick dealer with quick hands and quicker wit. Runs the poker and faro tables in the back. Rumored to have Frontera connections.',
        personality: 'Charming and calculating. Never loses at his own tables. Information broker on the side.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'Care to try your luck?',
          'House always wins... eventually.',
          'Big game tonight. Buy-in\'s steep, but the pot\'s worth it.',
          'I see all kinds pass through here. Some talk too much when they\'re losing.',
        ],
      },
      {
        id: 'dancing-jenny',
        name: 'Dancing Jenny',
        title: 'Entertainer',
        description: 'A fiery redhead from Mexico whose dancing draws crowds from three territories. Behind her dazzling smile lies a sharp mind that trades in secrets. She has cousins who ride with Martinez.',
        personality: 'Vivacious and flirtatious publicly, shrewd and calculating privately. Plays all factions against each other.',
        faction: 'FRONTERA',
        dialogue: [
          'Come to watch me dance, guapo? Or do you have business?',
          'Men say the most interesting things when they think I\'m just a pretty face.',
          'My cousins in the Frontera... they tell me things. Maybe useful things.',
          'Information is worth more than gold in this territory. And I collect both.',
        ],
        quests: ['gather-saloon-intelligence', 'contact-frontera-informant'],
      },
      {
        id: 'old-chen',
        name: 'Old Chen',
        title: 'Cook',
        description: 'An elderly Chinese man who escaped the railroad work camps thirty years ago. His cooking is legendary, but he remembers darker times. He speaks little of his past but watches everything.',
        personality: 'Quiet and observant. Fiercely loyal to those who treat him with respect. Carries old wounds.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          '*nods* Hungry? Stew good today.',
          'Railroad take many men. I survive. Many not survive.',
          'I watch, I remember. Old Chen see everything from kitchen.',
          '*in Cantonese* 他们以为我不懂英语... *switches to English* ...they think I don\'t understand.',
        ],
      },
    ],
    availableActions: ['gamble', 'buy-drink', 'gather-rumors', 'hire-guide', 'watch-performance'],
    availableCrimes: ['Pickpocket Drunk', 'Rob Saloon', 'Cheat at Cards', 'Blackmail Patron'],
    jobs: [
      {
        id: 'saloon-bouncer',
        name: 'Saloon Bouncer',
        description: 'Keep the peace and throw out troublemakers.',
        energyCost: 12,
        cooldownMinutes: 30,
        rewards: { goldMin: 12, goldMax: 20, xp: 20, items: [] },
        requirements: { minLevel: 3 },
      },
      {
        id: 'card-sharking',
        name: 'Card Sharking',
        description: 'Run rigged games with Lucky Lou. High risk, high reward.',
        energyCost: 20,
        cooldownMinutes: 60,
        rewards: { goldMin: 35, goldMax: 65, xp: 45, items: [] },
        requirements: { minLevel: 8 },
      },
      {
        id: 'info-broker',
        name: 'Information Broker',
        description: 'Collect and trade secrets from loose-lipped patrons. Work with Jenny.',
        energyCost: 15,
        cooldownMinutes: 45,
        rewards: { goldMin: 25, goldMax: 50, xp: 40, items: [] },
        requirements: { minLevel: 10 },
      },
      {
        id: 'saloon-manager',
        name: 'Saloon Manager',
        description: 'Run the establishment when Pete is away. Handle the books and special guests.',
        energyCost: 18,
        cooldownMinutes: 55,
        rewards: { goldMin: 40, goldMax: 70, xp: 55, items: [] },
        requirements: { minLevel: 12 },
      },
    ],
    shops: [
      {
        id: 'golden-spur-bar',
        name: 'Golden Spur Bar',
        description: 'Drinks, smokes, and Chen\'s famous cooking.',
        shopType: 'general',
        items: [
          { itemId: 'whiskey', name: 'Whiskey', description: 'Liquid courage', price: 3 },
          { itemId: 'beer', name: 'Beer', description: 'Cold brew', price: 1 },
          { itemId: 'cigar', name: 'Cigar', description: 'Fine tobacco', price: 5 },
          { itemId: 'chens-stew', name: 'Chen\'s Famous Stew', description: 'Hearty and mysterious', price: 4 },
          { itemId: 'jenny-perfume', name: 'Jenny\'s Favor', description: 'Perfumed token (+Charm)', price: 25, requiredLevel: 5 },
        ],
        buyMultiplier: 0.3,
      },
    ],
    secrets: [
      {
        id: 'back-room',
        name: 'The Back Room',
        description: 'A hidden room behind the bar where high-stakes games, black market deals, and secret meetings take place. The real power brokers of Red Gulch gather here when the saloon closes.',
        type: 'hidden_room',
        unlockCondition: {
          minReputation: 50,
          npcTrust: { npcId: 'whiskey-pete', level: 3 },
        },
        content: {
          actions: ['high-stakes-poker', 'fence-goods', 'buy-information', 'meet-shadow-broker'],
          npcs: ['shadow-broker'],
          dialogue: [
            'Welcome to the real game, friend. What\'s said in the back room stays here.',
            'Shadow Broker knows everyone\'s secrets. Including the Governor\'s.',
          ],
        },
      },
    ],
    connections: [],
    dangerLevel: 4,
    factionInfluence: { settlerAlliance: 60, nahiCoalition: 5, frontera: 35 },
    isUnlocked: true,
    isHidden: false,
  },

  // ===== 2. SHERIFF'S OFFICE (Enhanced) =====
  {
    _id: RED_GULCH_BUILDING_IDS.SHERIFFS_OFFICE,
    name: "Sheriff's Office",
    description: 'The stone building serves as Red Gulch\'s center of law enforcement. Wanted posters paper the walls, and the jail cells are rarely empty. Under Sheriff Hawk\'s stern gaze, justice is served—but some deputies question whether it\'s always the right kind.',
    shortDescription: 'Law enforcement headquarters with dark secrets',
    type: 'sheriff_office',
    region: 'town',
    parentId: LOCATION_IDS.RED_GULCH,
    tier: 3,
    dominantFaction: 'settler',
    operatingHours: { open: 0, close: 23 },
    atmosphere: 'The smell of coffee and gun oil pervades the air. Wanted posters flutter in the breeze from the open window. A locked filing cabinet in the corner contains cases that never got solved—or were deliberately buried.',
    requirements: { maxWanted: 30 },
    npcs: [
      {
        id: 'sheriff-john-hawk',
        name: 'Sheriff John Hawk',
        title: 'Sheriff',
        description: 'A tall, stern man with a silver star and steely eyes. He\'s seen too many good men go bad in this territory. Dedicated to the law, though some whisper he overlooks certain crimes for the right people.',
        personality: 'Strict but fair on the surface. Believes in order above all—sometimes at the cost of justice.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'Keep your nose clean in my town.',
          'Bounties are posted outside. Bring \'em in alive and there\'s a bonus.',
          'Justice is hard to come by out here. I aim to change that.',
          'Some cases are best left closed. For everyone\'s sake.',
        ],
        quests: ['clear-bounty', 'track-outlaw', 'investigate-cold-case'],
      },
      {
        id: 'deputy-mills',
        name: 'Deputy Mills',
        title: 'Deputy',
        description: 'A young, eager deputy still learning the ropes. Quick with a gun but quicker to talk. Loyal to the Sheriff without question.',
        personality: 'Enthusiastic and somewhat naive. Looks up to the Sheriff blindly.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'Sheriff\'s busy, but I can help you.',
          'You seen any suspicious characters around?',
          'Someday I\'ll be sheriff of my own town.',
        ],
      },
      {
        id: 'deputy-running-deer',
        name: 'Deputy Running Deer',
        title: 'Deputy',
        description: 'A Nahi man who took the deputy position to bridge the gap between his people and the settlers. He sees the corruption others miss and struggles with his conscience. Some call him a traitor, others a peacemaker.',
        personality: 'Thoughtful and torn. Sympathetic to Nahi causes but bound by his badge. Questions orders quietly.',
        faction: 'NAHI_COALITION',
        dialogue: [
          'I walk between two worlds. Neither fully trusts me.',
          'The law should protect all people. Even when it doesn\'t.',
          'Some of these "wanted" men are heroes to my people. It weighs on me.',
          'If you hear of injustice against the Nahi... I want to know. Quietly.',
        ],
        quests: ['nahi-justice', 'peaceful-resolution'],
      },
    ],
    availableActions: ['check-bounties', 'turn-in-criminal', 'report-crime', 'pay-fine', 'request-protection'],
    availableCrimes: ['Bribe Official', 'Steal Evidence', 'Free Prisoner'],
    jobs: [
      {
        id: 'bounty-hunting',
        name: 'Bounty Hunting',
        description: 'Track down wanted criminals and bring them to justice.',
        energyCost: 25,
        cooldownMinutes: 60,
        rewards: { goldMin: 30, goldMax: 60, xp: 50, items: [] },
        requirements: { minLevel: 5 },
      },
      {
        id: 'deputy-patrol',
        name: 'Deputy Patrol',
        description: 'Walk the streets and keep the peace.',
        energyCost: 15,
        cooldownMinutes: 30,
        rewards: { goldMin: 15, goldMax: 25, xp: 25, items: [] },
        requirements: { minLevel: 1 },
      },
      {
        id: 'marshal-escort',
        name: 'Marshal Escort',
        description: 'Escort high-value prisoners or officials through dangerous territory.',
        energyCost: 22,
        cooldownMinutes: 50,
        rewards: { goldMin: 40, goldMax: 70, xp: 55, items: [] },
        requirements: { minLevel: 8 },
      },
      {
        id: 'investigation-work',
        name: 'Investigation Work',
        description: 'Assist with complex criminal investigations. Gather evidence, interview witnesses.',
        energyCost: 18,
        cooldownMinutes: 45,
        rewards: { goldMin: 30, goldMax: 55, xp: 50, items: [] },
        requirements: { minLevel: 10 },
      },
      {
        id: 'track-target',
        name: 'Track High-Value Target',
        description: 'Hunt the territory\'s most dangerous outlaws. Elite bounty work.',
        energyCost: 30,
        cooldownMinutes: 90,
        rewards: { goldMin: 60, goldMax: 120, xp: 80, items: [] },
        requirements: { minLevel: 12 },
      },
    ],
    shops: [],
    secrets: [
      {
        id: 'cold-case-files',
        name: 'Cold Case Files',
        description: 'A locked cabinet contains evidence of corruption reaching to the Governor\'s office. Unsolved murders, covered-up land grabs, and testimony that was "lost." Deputy Running Deer suspects it exists.',
        type: 'hidden_room',
        unlockCondition: {
          minReputation: 60,
          npcTrust: { npcId: 'deputy-running-deer', level: 4 },
        },
        content: {
          actions: ['study-evidence', 'copy-documents', 'confront-sheriff'],
          npcs: [],
          dialogue: [
            'These files could bring down powerful men. The question is: are you ready for what happens next?',
            'The Governor\'s name appears in three unsolved cases. All witnesses are dead.',
          ],
        },
      },
    ],
    connections: [],
    dangerLevel: 2,
    factionInfluence: { settlerAlliance: 85, nahiCoalition: 10, frontera: 5 },
    isUnlocked: true,
    isHidden: false,
  },

  // ===== 3. MINER'S SUPPLY CO (Enhanced) =====
  {
    _id: RED_GULCH_BUILDING_IDS.MINERS_SUPPLY,
    name: "Miner's Supply Co",
    description: 'The largest general store in Red Gulch, stocked with everything a prospector or settler could need. Martha Chen runs the legitimate business upstairs while her nephew Wei manages inventory—including some items that never appear on the books.',
    shortDescription: 'General goods, mining supplies, and hidden smuggling',
    type: 'general_store',
    region: 'town',
    parentId: LOCATION_IDS.RED_GULCH,
    tier: 3,
    dominantFaction: 'settler',
    operatingHours: { open: 7, close: 20 },
    atmosphere: 'Shelves packed with goods stretch to the ceiling. The smell of leather, tobacco, and dried goods fills the store. Martha\'s abacus clicks steadily as she tallies purchases. Wei moves quietly between rows, occasionally slipping down to the cellar.',
    npcs: [
      {
        id: 'martha-chen',
        name: 'Martha Chen',
        title: 'Shopkeeper',
        description: 'A shrewd businesswoman who came west with the railroad. She knows the value of everything and the price of everyone. Her family\'s connections run deep on both sides of the law.',
        personality: 'Sharp-tongued but honest in open business. Protective of family and community.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'What do you need? I ain\'t got all day.',
          'Best prices in town. Check anywhere else if you don\'t believe me.',
          'Cash only. I don\'t take promises.',
          'My nephew Wei handles the... special inventory. If you need something specific.',
        ],
        isVendor: true,
        shopId: 'miners-supply-shop',
      },
      {
        id: 'wei-chen',
        name: 'Wei Chen',
        title: 'Stock Boy',
        description: 'Martha\'s nephew, a young Chinese man who manages inventory and runs the secret smuggling operation in the cellar. He helps Chinese workers escape bad situations and moves goods the Company doesn\'t want tracked.',
        personality: 'Quiet and cautious around strangers. Brave and resourceful when it matters. Loyal to his community.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          '*in accented English* Can I help you find something?',
          'Aunt Martha handles main business. I handle... other things.',
          'Sometimes people need help leaving the mining camps. I help.',
          'The cellar? Just storage. Nothing interesting down there.',
        ],
        quests: ['smuggle-workers', 'hidden-delivery'],
      },
      {
        id: 'grizzly-tom',
        name: 'Grizzly Tom',
        title: 'Old Prospector',
        description: 'A massive, bearded old-timer who\'s been prospecting these hills for forty years. He knows every claim, every vein, and every prospector\'s story. Lost his partner to a claim jumper in \'72.',
        personality: 'Gruff but helpful. Loves to tell stories. Suspicious of newcomers until they prove themselves.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'Looking for a claim? I know spots the Company ain\'t found yet.',
          'Forty years in these hills. I know where the gold sings.',
          'Lost my partner to claim jumpers. Don\'t trust the Company men.',
          'Buy me a whiskey at the Spur and I\'ll tell you about the Lost Dutchman.',
        ],
        quests: ['find-lost-claim', 'prospector-tales'],
      },
    ],
    availableActions: ['buy', 'sell', 'special-order', 'check-cellar'],
    availableCrimes: ['Burglarize Store', 'Pickpocket', 'Smuggle Contraband'],
    jobs: [
      {
        id: 'stock-shelves',
        name: 'Stock Shelves',
        description: 'Help unload wagons and organize inventory.',
        energyCost: 10,
        cooldownMinutes: 20,
        rewards: { goldMin: 8, goldMax: 14, xp: 15, items: [] },
        requirements: { minLevel: 1 },
      },
      {
        id: 'supply-run',
        name: 'Supply Run',
        description: 'Deliver goods to miners and prospectors in the surrounding area.',
        energyCost: 15,
        cooldownMinutes: 35,
        rewards: { goldMin: 18, goldMax: 32, xp: 30, items: [] },
        requirements: { minLevel: 5 },
      },
      {
        id: 'inventory-manager',
        name: 'Inventory Manager',
        description: 'Manage the store\'s inventory and handle special orders.',
        energyCost: 18,
        cooldownMinutes: 45,
        rewards: { goldMin: 30, goldMax: 50, xp: 45, items: [] },
        requirements: { minLevel: 8 },
      },
      {
        id: 'claim-agent',
        name: 'Claim Agent',
        description: 'Help prospectors file claims, verify boundaries, and navigate Company bureaucracy.',
        energyCost: 22,
        cooldownMinutes: 60,
        rewards: { goldMin: 45, goldMax: 80, xp: 60, items: [] },
        requirements: { minLevel: 12 },
      },
    ],
    shops: [
      {
        id: 'miners-supply-shop',
        name: "Miner's Supply Co",
        description: 'General goods and mining equipment.',
        shopType: 'general',
        items: [
          { itemId: 'pickaxe', name: 'Pickaxe', description: 'Essential for mining', price: 25 },
          { itemId: 'shovel', name: 'Shovel', description: 'For digging', price: 15 },
          { itemId: 'lantern', name: 'Oil Lantern', description: 'Light your way', price: 12 },
          { itemId: 'rope', name: 'Rope (50ft)', description: 'Strong hemp rope', price: 8 },
          { itemId: 'bandages', name: 'Bandages', description: 'Basic first aid', price: 5 },
          { itemId: 'rations', name: 'Trail Rations', description: 'A week\'s worth', price: 10 },
          { itemId: 'lockpicks', name: 'Lockpick Set', description: 'For professionals', price: 50, requiredLevel: 5 },
          { itemId: 'mining-canary', name: 'Mining Canary', description: 'Gas detector (live bird)', price: 15 },
          { itemId: 'claim-stake', name: 'Claim Stakes (Set)', description: 'Mark your territory', price: 20 },
        ],
        buyMultiplier: 0.5,
      },
    ],
    secrets: [
      {
        id: 'hidden-cellar',
        name: 'The Hidden Cellar',
        description: 'Below the store lies a smuggling operation. Wei helps Chinese workers escape brutal mining conditions and moves goods the Company tracks. Contraband, forged papers, and an escape route to the Chinese Quarter.',
        type: 'hidden_room',
        unlockCondition: {
          minReputation: 40,
          npcTrust: { npcId: 'wei-chen', level: 3 },
        },
        content: {
          actions: ['buy-contraband', 'forge-documents', 'arrange-escape', 'access-tunnel'],
          npcs: [],
          dialogue: [
            'You see what we do here. Help us, and the community remembers. Betray us...',
            'This tunnel connects to Mei Ling\'s. She handles the other end.',
          ],
        },
      },
    ],
    connections: [],
    dangerLevel: 1,
    factionInfluence: { settlerAlliance: 75, nahiCoalition: 5, frontera: 20 },
    isUnlocked: true,
    isHidden: false,
  },

  // ===== 4. RED GULCH BANK (Enhanced) =====
  {
    _id: RED_GULCH_BUILDING_IDS.RED_GULCH_BANK,
    name: 'Red Gulch Bank',
    description: 'The territory\'s most secure bank, built with thick walls and a state-of-the-art vault. Cornelius Finch guards the miners\' fortunes with zealous dedication—but the real secrets lie in the Governor\'s private ledger, locked away from prying eyes.',
    shortDescription: 'Secure banking, vault services, and dirty secrets',
    type: 'bank',
    region: 'town',
    parentId: LOCATION_IDS.RED_GULCH,
    tier: 3,
    dominantFaction: 'settler',
    operatingHours: { open: 8, close: 18 },
    atmosphere: 'Polished marble floors reflect the gas lamps. The heavy vault door stands behind iron bars. Armed guards watch every customer. Hushed conversations happen in the private offices upstairs where the real deals are made.',
    npcs: [
      {
        id: 'cornelius-finch',
        name: 'Cornelius Finch',
        title: 'Head Banker',
        description: 'A fastidious man in a three-piece suit who treats every cent as sacred. His ledgers are immaculate—the official ones, at least. He knows where the Governor\'s money comes from.',
        personality: 'Precise, formal, and deeply conflicted. Follows orders but carries guilt.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'Welcome to Red Gulch Bank. How may I assist you?',
          'Your funds are perfectly secure here, I assure you.',
          'We offer competitive interest rates for deposits over $1000.',
          '*whispers* Some accounts... I wish I didn\'t have to maintain.',
        ],
        isVendor: false,
        quests: ['secure-deposit', 'investigate-accounts'],
      },
      {
        id: 'rosalita-vasquez',
        name: 'Rosalita Vasquez',
        title: 'Bank Clerk',
        description: 'A beautiful young woman from Mexico City whose cousin rides with the Martinez gang. She sends money home to her family and passes information when she can. Her smile hides sharp eyes.',
        personality: 'Charming and efficient publicly. Secretly sympathizes with Frontera and family above all.',
        faction: 'FRONTERA',
        dialogue: [
          'How may I help you today, señor?',
          'My family in Mexico... they depend on me. I do what I must.',
          'The vault schedules? Why would you need to know that?',
          '*in Spanish* Mi primo pregunta sobre los envíos... *in English* ...sorry, just counting.',
        ],
        quests: ['frontera-contact', 'family-loyalty'],
      },
      {
        id: 'samuel-mcgraw',
        name: 'Samuel McGraw',
        title: 'Head of Security',
        description: 'A former Army sergeant with a ramrod posture and eagle eyes. He\'s killed four bank robbers and wounded a dozen more. The vault is his sacred charge.',
        personality: 'Disciplined, vigilant, and incorruptible regarding the vault. Less careful about who owns what\'s inside.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'Eyes up. Hands where I can see them.',
          'Vault hasn\'t been breached in twelve years. Won\'t happen on my watch.',
          'Army taught me to follow orders. Bank taught me to protect assets.',
          'I don\'t ask where the money comes from. I ask who\'s trying to take it.',
        ],
      },
    ],
    availableActions: ['deposit', 'withdraw', 'check-balance', 'open-account', 'transfer', 'upgrade-vault'],
    availableCrimes: ['Bank Heist', 'Forge Documents', 'Bribe Clerk', 'Inside Job'],
    jobs: [
      {
        id: 'bank-clerk',
        name: 'Bank Clerk',
        description: 'Handle basic transactions and customer service.',
        energyCost: 10,
        cooldownMinutes: 25,
        rewards: { goldMin: 12, goldMax: 20, xp: 18, items: [] },
        requirements: { minLevel: 1 },
      },
      {
        id: 'loan-collections',
        name: 'Loan Collections',
        description: 'Collect overdue payments from miners and businessmen. Persuasion or force.',
        energyCost: 15,
        cooldownMinutes: 40,
        rewards: { goldMin: 25, goldMax: 45, xp: 35, items: [] },
        requirements: { minLevel: 5 },
      },
      {
        id: 'vault-guard',
        name: 'Vault Guard',
        description: 'Assist Samuel McGraw with vault security. High trust required.',
        energyCost: 20,
        cooldownMinutes: 55,
        rewards: { goldMin: 40, goldMax: 65, xp: 55, items: [] },
        requirements: { minLevel: 10 },
      },
      {
        id: 'bank-manager',
        name: 'Bank Manager',
        description: 'Handle high-value accounts and sensitive transactions. Access to private records.',
        energyCost: 25,
        cooldownMinutes: 75,
        rewards: { goldMin: 60, goldMax: 100, xp: 75, items: [] },
        requirements: { minLevel: 15 },
      },
    ],
    shops: [],
    secrets: [
      {
        id: 'governors-ledger',
        name: "The Governor's Ledger",
        description: 'A hidden ledger in Finch\'s office documents bribes, land fraud, and payments to silence witnesses. It ties Governor Ashford to the Quiet Creek massacre and mining claim thefts. Political dynamite.',
        type: 'hidden_room',
        unlockCondition: {
          minReputation: 70,
          npcTrust: { npcId: 'cornelius-finch', level: 4 },
        },
        content: {
          actions: ['study-ledger', 'copy-evidence', 'blackmail-governor', 'expose-corruption'],
          npcs: [],
          dialogue: [
            'This ledger could destroy the Governor—or make you very rich. Choose wisely.',
            'Every bribe, every theft, every silenced witness. It\'s all here.',
          ],
        },
      },
    ],
    connections: [],
    dangerLevel: 3,
    factionInfluence: { settlerAlliance: 85, nahiCoalition: 0, frontera: 15 },
    isUnlocked: true,
    isHidden: false,
  },

  // ===== 5. IRON JAKE'S FORGE (Enhanced) =====
  {
    _id: RED_GULCH_BUILDING_IDS.IRON_JAKES_FORGE,
    name: "Iron Jake's Forge",
    description: 'The sound of hammering never stops at Iron Jake\'s. He crafts everything from horseshoes to gun barrels, and his work is known throughout the territory. His apprentice Li Jian shows promise, despite the scars, and One-Arm Wilson handles the "special" commissions.',
    shortDescription: 'Blacksmith, gunsmith, and illegal weapons',
    type: 'blacksmith',
    region: 'town',
    parentId: LOCATION_IDS.RED_GULCH,
    tier: 3,
    dominantFaction: 'settler',
    operatingHours: { open: 6, close: 20 },
    atmosphere: 'The forge glows red-hot, casting dancing shadows. Sparks fly as hammer meets metal. The smell of coal smoke and hot iron fills the air. In the back, behind locked doors, more specialized work is done.',
    npcs: [
      {
        id: 'iron-jake',
        name: 'Iron Jake',
        title: 'Master Blacksmith',
        description: 'A massive man with arms like tree trunks and hands scarred by decades of forge work. His craftsmanship is unmatched. He took in Li Jian when no one else would.',
        personality: 'Quiet and focused. Respects hard work and quality. Surprisingly progressive about his apprentice.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          '*grunt* What do you need?',
          'Good steel takes time. Come back tomorrow.',
          'You want it fast or you want it right?',
          'Li Jian\'s got talent. Don\'t care what color his skin is. Steel doesn\'t either.',
        ],
        isVendor: true,
        shopId: 'iron-jakes-shop',
      },
      {
        id: 'li-jian',
        name: 'Li Jian',
        title: 'Apprentice Blacksmith',
        description: 'A young Chinese man with burn scars on his arms and face from a mining accident. Jake took him in when the Company left him to die. He\'s learning the forge with fierce determination.',
        personality: 'Determined and grateful. Carries anger at the Company. Dreams of opening his own forge someday.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          '*working metal* Mr. Jake is teaching me well.',
          'These scars? Mining accident. Company said I was worthless after. Jake disagreed.',
          'I will make the finest blades. Better than any the Company imports.',
          'The Chinese Quarter... my people need a blacksmith. Someday.',
        ],
        quests: ['apprentice-journey', 'forge-masterpiece'],
      },
      {
        id: 'one-arm-wilson',
        name: 'One-Arm Wilson',
        title: 'Gun Expert',
        description: 'Lost his left arm in the War but gained an encyclopedic knowledge of firearms. He handles the "special commissions"—modified weapons, illegal modifications, and guns that officially don\'t exist.',
        personality: 'Cynical, knowledgeable, and discreet. Doesn\'t ask questions or answer them.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'Lost the arm at Gettysburg. Kept the expertise.',
          'You want something special? I can make it. For a price.',
          'These modifications don\'t exist. Neither does this conversation.',
          'Hair triggers, sawed-off barrels, hidden holsters. Name your poison.',
        ],
        quests: ['custom-weapon', 'arms-dealer'],
      },
    ],
    availableActions: ['buy', 'repair', 'custom-order', 'upgrade-weapon', 'special-commission'],
    availableCrimes: ['Steal Weapons', 'Illegal Modifications'],
    jobs: [
      {
        id: 'forge-assistant',
        name: 'Forge Assistant',
        description: 'Work the bellows and help with metalwork.',
        energyCost: 15,
        cooldownMinutes: 30,
        rewards: { goldMin: 12, goldMax: 22, xp: 25, items: [] },
        requirements: { minLevel: 2 },
      },
      {
        id: 'weapon-repair',
        name: 'Weapon Repair',
        description: 'Fix damaged weapons for customers. Requires skill.',
        energyCost: 18,
        cooldownMinutes: 40,
        rewards: { goldMin: 25, goldMax: 45, xp: 40, items: [] },
        requirements: { minLevel: 5 },
      },
      {
        id: 'secret-commissions',
        name: 'Secret Commissions',
        description: 'Help Wilson with illegal weapon modifications. Discrete and profitable.',
        energyCost: 22,
        cooldownMinutes: 55,
        rewards: { goldMin: 45, goldMax: 75, xp: 55, items: [] },
        requirements: { minLevel: 10 },
      },
      {
        id: 'master-smith',
        name: 'Master Smith Work',
        description: 'Create custom pieces for elite clients. Jake\'s reputation rides on quality.',
        energyCost: 28,
        cooldownMinutes: 80,
        rewards: { goldMin: 65, goldMax: 110, xp: 75, items: [] },
        requirements: { minLevel: 12 },
      },
    ],
    shops: [
      {
        id: 'iron-jakes-shop',
        name: "Iron Jake's Forge",
        description: 'Quality metalwork and repairs.',
        shopType: 'weapons',
        items: [
          { itemId: 'horseshoes', name: 'Horseshoes (Set)', description: 'Keep your mount shod', price: 20 },
          { itemId: 'knife', name: 'Hunting Knife', description: 'Sharp and reliable', price: 15 },
          { itemId: 'hatchet', name: 'Hatchet', description: 'Good for wood and skulls', price: 25 },
          { itemId: 'reinforced-barrel', name: 'Reinforced Barrel', description: 'Gun upgrade component', price: 75, requiredLevel: 8 },
          { itemId: 'cavalry-saber', name: 'Cavalry Saber', description: 'Civil War surplus', price: 60, requiredLevel: 6 },
        ],
        buyMultiplier: 0.4,
      },
    ],
    secrets: [
      {
        id: 'the-arsenal',
        name: 'The Arsenal',
        description: 'Hidden behind a false wall is Wilson\'s workshop. Illegal weapons, modified firearms, and military-grade equipment that officially doesn\'t exist. A small fortune in contraband.',
        type: 'hidden_room',
        unlockCondition: {
          minReputation: 55,
          npcTrust: { npcId: 'one-arm-wilson', level: 4 },
        },
        content: {
          actions: ['buy-illegal-weapons', 'commission-custom', 'military-contacts'],
          npcs: [],
          dialogue: [
            'Welcome to the real inventory. What you see here stays between us.',
            'Gatling parts, dynamite, modified Winchesters. I\'ve got it all.',
          ],
        },
      },
    ],
    connections: [],
    dangerLevel: 2,
    factionInfluence: { settlerAlliance: 75, nahiCoalition: 10, frontera: 15 },
    isUnlocked: true,
    isHidden: false,
  },

  // ===== 6. GULCH ASSAY OFFICE (Enhanced) =====
  {
    _id: RED_GULCH_BUILDING_IDS.GULCH_ASSAY_OFFICE,
    name: 'Gulch Assay Office',
    description: 'The official mineral assay office where miners bring their finds to be weighed, tested, and certified. Thomas Weaver\'s assessments are the gold standard—but his assistant Edmund Patterson\'s are for sale to the highest bidder.',
    shortDescription: 'Mineral testing, claim certification, and fraud',
    type: 'assay_office',
    region: 'town',
    parentId: LOCATION_IDS.RED_GULCH,
    tier: 3,
    dominantFaction: 'settler',
    operatingHours: { open: 8, close: 17 },
    atmosphere: 'Scales and testing equipment cover every surface. Samples of ore in labeled jars line the shelves. The chemical smell of testing solutions fills the room. Stacks of claim documents tower on Edmund\'s desk.',
    npcs: [
      {
        id: 'thomas-weaver',
        name: 'Thomas Weaver',
        title: 'Chief Assayer',
        description: 'A scholarly man with spectacles and ink-stained fingers. He can identify ore quality with a glance. Honest to a fault, which is why his daughter Lucy questions the system he serves.',
        personality: 'Methodical and honest. Takes pride in accurate assessments. Oblivious to corruption around him.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'Place your sample on the scale, please.',
          'Hmm, interesting composition... let me run some tests.',
          'I\'ll have your certificate ready within the hour.',
          'My assessments are never wrong. I stake my reputation on them.',
        ],
      },
      {
        id: 'lucy-weaver',
        name: 'Lucy Weaver',
        title: 'Assistant Assayer',
        description: 'Thomas\'s daughter, trained in chemistry and geology. She\'s seen how the Company manipulates assessments to steal claims and has grown sympathetic to the Coalition\'s land rights arguments.',
        personality: 'Intelligent and idealistic. Increasingly radicalized by injustice. Caught between loyalty to her father and her conscience.',
        faction: 'NAHI_COALITION',
        dialogue: [
          'Father\'s methods are accurate. The system around them is not.',
          'I\'ve seen the Company forge assessments. It makes me sick.',
          'The Nahi had these lands first. Our "claims" are just theft with paperwork.',
          'If you want honest work done, bring it directly to me.',
        ],
        quests: ['expose-fraud', 'nahi-land-rights'],
      },
      {
        id: 'edmund-patterson',
        name: 'Edmund Patterson',
        title: 'Claims Registrar',
        description: 'A oily man who handles claim registrations. His books are cooked, his stamps are for sale, and he\'s bankrupted more honest miners than any outlaw. Works directly for the Company.',
        personality: 'Corrupt, greedy, and deeply resentful of those who succeeded honestly.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'Registration fee is fifty dollars. Plus... processing costs.',
          'That claim you want? Someone else filed first. Unless...',
          'The Company pays well for certain information. You could too.',
          'Honest work is for fools. Smart men work the system.',
        ],
        quests: ['bribe-registrar', 'expose-patterson'],
      },
    ],
    availableActions: ['assay-ore', 'sell-gold', 'check-prices', 'file-claim', 'verify-claim'],
    availableCrimes: ['Forge Documents', 'Bribe Official', 'Claim Fraud', 'Steal Samples'],
    jobs: [
      {
        id: 'assay-clerk',
        name: 'Assay Clerk',
        description: 'Help with paperwork and sample organization.',
        energyCost: 10,
        cooldownMinutes: 25,
        rewards: { goldMin: 10, goldMax: 18, xp: 20, items: [] },
        requirements: { minLevel: 1 },
      },
      {
        id: 'ore-testing',
        name: 'Ore Testing',
        description: 'Perform basic mineral analysis on samples.',
        energyCost: 14,
        cooldownMinutes: 35,
        rewards: { goldMin: 18, goldMax: 32, xp: 30, items: [] },
        requirements: { minLevel: 3 },
      },
      {
        id: 'claim-verification',
        name: 'Claim Verification',
        description: 'Survey and verify mining claims in the field.',
        energyCost: 20,
        cooldownMinutes: 50,
        rewards: { goldMin: 35, goldMax: 60, xp: 50, items: [] },
        requirements: { minLevel: 8 },
      },
      {
        id: 'chief-assayer',
        name: 'Chief Assayer Work',
        description: 'Handle high-value assessments and official certifications.',
        energyCost: 25,
        cooldownMinutes: 70,
        rewards: { goldMin: 55, goldMax: 95, xp: 70, items: [] },
        requirements: { minLevel: 12 },
      },
    ],
    shops: [
      {
        id: 'assay-supplies',
        name: 'Assay Supplies',
        description: 'Testing equipment and claim materials.',
        shopType: 'general',
        items: [
          { itemId: 'testing-kit', name: 'Basic Testing Kit', description: 'Acid tests for gold', price: 35 },
          { itemId: 'claim-map', name: 'Territory Claim Map', description: 'Shows registered claims', price: 25 },
          { itemId: 'survey-tools', name: 'Survey Tools', description: 'For marking claims', price: 45 },
          { itemId: 'gold-scale', name: 'Precision Gold Scale', description: 'Accurate to the grain', price: 75, requiredLevel: 5 },
        ],
        buyMultiplier: 0.4,
      },
    ],
    secrets: [
      {
        id: 'cooked-books',
        name: 'The Cooked Books',
        description: 'Lucy has discovered and hidden copies of Patterson\'s fraud records. Falsified assessments, stolen claims, and payments from the Company. Evidence that could expose years of systematic theft.',
        type: 'hidden_room',
        unlockCondition: {
          minReputation: 50,
          npcTrust: { npcId: 'lucy-weaver', level: 4 },
        },
        content: {
          actions: ['study-fraud-records', 'copy-evidence', 'confront-patterson', 'contact-journalists'],
          npcs: [],
          dialogue: [
            'I\'ve documented everything. The Company stole dozens of claims through Patterson.',
            'This evidence could restore land to families who lost everything. Use it well.',
          ],
        },
      },
    ],
    connections: [],
    dangerLevel: 1,
    factionInfluence: { settlerAlliance: 80, nahiCoalition: 15, frontera: 5 },
    isUnlocked: true,
    isHidden: false,
  },

  // ===== 7. DOC MORRISON'S (Enhanced) =====
  {
    _id: RED_GULCH_BUILDING_IDS.DOC_MORRISONS,
    name: "Doc Morrison's",
    description: 'The only doctor\'s office in Red Gulch. Doc Morrison handles everything from bullet wounds to childbirth, often after a few drinks himself. Dr. Huang Wei practices traditional Chinese medicine in the back, and Nurse Clara keeps both men from killing their patients.',
    shortDescription: 'Medical treatment, Chinese medicine, and no-questions care',
    type: 'doctors_office',
    region: 'town',
    parentId: LOCATION_IDS.RED_GULCH,
    tier: 3,
    dominantFaction: 'settler',
    operatingHours: { open: 0, close: 23 },
    atmosphere: 'The smell of alcohol and laudanum mingles with carbolic soap and Chinese herbs. Medical instruments gleam in glass cases. A bloodstained operating table dominates the main room while the back is filled with mysterious jars and acupuncture needles.',
    npcs: [
      {
        id: 'doc-morrison',
        name: 'Doc Morrison',
        title: 'Doctor',
        description: 'A former Army surgeon with steady hands despite his fondness for whiskey. He\'s seen every injury the frontier can dish out and asks no questions about how they happened.',
        personality: 'Cynical but competent. Dark sense of humor. Will treat anyone who can pay—or anyone who can\'t, if Clara insists.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'What seems to be the problem? And don\'t waste my time.',
          'I\'ve patched up worse. You\'ll live.',
          'Payment up front. I\'ve been stiffed by too many dead men.',
          'Huang\'s herbs work. Don\'t understand how, but they do.',
        ],
        isVendor: true,
        shopId: 'doc-morrisons-shop',
      },
      {
        id: 'nurse-clara',
        name: 'Nurse Clara',
        title: 'Head Nurse',
        description: 'A no-nonsense woman who keeps the practice running. She trained under Morrison and learned Chinese medicine from Huang. She runs the "no-questions" back room for those who can\'t go to the law.',
        personality: 'Practical, compassionate, and fiercely protective of patients. Doesn\'t judge how wounds happen.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'Doc\'s drunk again. I\'ll handle your stitches.',
          'The back room is for special cases. No names, no questions.',
          'I\'ve treated outlaws, deputies, and everyone in between. All bleed the same.',
          'Huang\'s remedies complement Western medicine. Don\'t tell the Doc I said so.',
        ],
        quests: ['discreet-treatment', 'medical-supplies'],
      },
      {
        id: 'dr-huang-wei',
        name: 'Dr. Huang Wei',
        title: 'Traditional Medicine Practitioner',
        description: 'An elderly Chinese doctor trained in traditional medicine. He fled persecution in San Francisco and set up practice in the back rooms. His treatments are mysterious to Western eyes but undeniably effective.',
        personality: 'Patient, wise, and quietly defiant. Carries the knowledge of centuries.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          '*examines patient* Western medicine treats symptoms. I treat the source.',
          'Acupuncture realigns the qi. You feel better because balance is restored.',
          'I trained in Guangzhou for twenty years. Your skepticism does not concern me.',
          'Some ailments require herbs, some require needles, some require time.',
        ],
        quests: ['chinese-medicine-quest', 'rare-herbs'],
      },
    ],
    availableActions: ['heal', 'buy-medicine', 'cure-ailment', 'surgery', 'acupuncture', 'discreet-treatment'],
    availableCrimes: ['Steal Drugs', 'Forge Medical Records'],
    jobs: [
      {
        id: 'medical-assistant',
        name: 'Medical Assistant',
        description: 'Help with basic care, bandaging, and cleaning.',
        energyCost: 12,
        cooldownMinutes: 30,
        rewards: { goldMin: 14, goldMax: 24, xp: 22, items: [] },
        requirements: { minLevel: 2 },
      },
      {
        id: 'surgery-assist',
        name: 'Surgery Assistant',
        description: 'Assist Doc Morrison with complex surgeries. Not for the squeamish.',
        energyCost: 20,
        cooldownMinutes: 50,
        rewards: { goldMin: 35, goldMax: 60, xp: 50, items: [] },
        requirements: { minLevel: 8 },
      },
      {
        id: 'field-medicine',
        name: 'Field Medicine',
        description: 'Provide medical care in the field—mining accidents, outlaw hideouts, wherever needed.',
        energyCost: 25,
        cooldownMinutes: 65,
        rewards: { goldMin: 50, goldMax: 85, xp: 65, items: [] },
        requirements: { minLevel: 12 },
      },
    ],
    shops: [
      {
        id: 'doc-morrisons-shop',
        name: "Doc Morrison's Supplies",
        description: 'Western medical supplies and treatments.',
        shopType: 'medicine',
        items: [
          { itemId: 'bandages', name: 'Bandages', description: 'Sterile wrappings', price: 5 },
          { itemId: 'health-tonic', name: 'Health Tonic', description: 'Restores vitality', price: 25 },
          { itemId: 'laudanum', name: 'Laudanum', description: 'Pain relief (addictive)', price: 15 },
          { itemId: 'antivenom', name: 'Antivenom', description: 'Cures snake bites', price: 40 },
          { itemId: 'surgery-kit', name: 'Surgery Kit', description: 'For field operations', price: 100, requiredLevel: 10 },
        ],
        buyMultiplier: 0.4,
      },
      {
        id: 'huang-remedies',
        name: 'Dr. Huang\'s Remedies',
        description: 'Traditional Chinese medicine.',
        shopType: 'medicine',
        items: [
          { itemId: 'healing-tea', name: 'Healing Tea', description: 'Restores 20 HP over time', price: 8 },
          { itemId: 'green-tea', name: 'Green Tea', description: 'Restores 5 energy', price: 3 },
          { itemId: 'lung-tonic', name: 'Lung Tonic', description: 'Cures respiratory ailments', price: 25 },
          { itemId: 'qi-tonic', name: 'Qi Tonic', description: 'Restores stamina (+20 energy)', price: 30, requiredLevel: 5 },
          { itemId: 'tiger-balm', name: 'Tiger Balm', description: 'Healing +50% for 1 hour', price: 60, requiredLevel: 8 },
        ],
        buyMultiplier: 0.5,
      },
    ],
    secrets: [
      {
        id: 'back-room-clinic',
        name: 'The Back Room',
        description: 'A no-questions clinic for those who can\'t seek official help. Outlaws, abuse victims, those hiding from the law. Clara runs it with discretion and compassion. Huang provides treatments that leave no official records.',
        type: 'hidden_room',
        unlockCondition: {
          minReputation: 45,
          npcTrust: { npcId: 'nurse-clara', level: 3 },
        },
        content: {
          actions: ['discreet-treatment', 'unofficial-surgery', 'hide-patient', 'no-records-care'],
          npcs: [],
          dialogue: [
            'What happens in the back room stays in the back room. We heal people, not judge them.',
            'The law doesn\'t need to know every bullet wound I stitch.',
          ],
        },
      },
    ],
    connections: [],
    dangerLevel: 1,
    factionInfluence: { settlerAlliance: 70, nahiCoalition: 15, frontera: 15 },
    isUnlocked: true,
    isHidden: false,
  },

  // ===== 8. DUSTY TRAILS HOTEL (Enhanced) =====
  {
    _id: RED_GULCH_BUILDING_IDS.DUSTY_TRAILS_HOTEL,
    name: 'Dusty Trails Hotel',
    description: 'The finest (and only) hotel in Red Gulch. Agnes Miller runs a tight ship with clean sheets, hot water, and absolutely no tolerance for troublemakers. But every guest who\'s passed through has left traces in the guest register—and Su Mei remembers them all.',
    shortDescription: 'Lodging, rest, and decades of recorded secrets',
    type: 'hotel',
    region: 'town',
    parentId: LOCATION_IDS.RED_GULCH,
    tier: 3,
    dominantFaction: 'settler',
    operatingHours: { open: 0, close: 23 },
    atmosphere: 'A clean lobby with worn but comfortable furniture. The smell of coffee and fresh bread drifts from the kitchen. Keys hang in neat rows behind the desk. Su Mei folds laundry while Brother Ezekiel reads Scripture in the corner.',
    npcs: [
      {
        id: 'agnes-miller',
        name: 'Agnes Miller',
        title: 'Innkeeper',
        description: 'A formidable widow who built this hotel with her own hands after her husband died. She keeps a shotgun under the counter and knows everyone who\'s ever stayed here.',
        personality: 'Stern but motherly. Doesn\'t tolerate nonsense. Protective of her guests and secretly runs an intelligence network.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'Welcome to the Dusty Trails. Rooms are $2 a night, meals included.',
          'No spitting, no fighting, no women of ill repute. Clear?',
          'Breakfast is at 7. Don\'t be late or you don\'t eat.',
          'Forty years of guest registers. Every name, every date. Memory lasts.',
        ],
      },
      {
        id: 'su-mei',
        name: 'Su Mei',
        title: 'Laundress',
        description: 'A quiet Chinese woman who handles the laundry and housekeeping. She\'s Mei Ling\'s eyes and ears in the settler world, and nothing escapes her attention. She can read English perfectly despite pretending otherwise.',
        personality: 'Observant, patient, and utterly loyal to Mei Ling. Plays the "simple laundress" role perfectly.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          '*bows* I clean, I wash. Good work, yes?',
          '*in Cantonese* 他们从不检查洗衣... *in English* ...very clean sheets, yes.',
          'Guest leave many things. Papers, letters. I return to owner.',
          '*whispers* Mei Ling should know about Room 7 guest. Very interesting papers.',
        ],
        quests: ['intelligence-gathering', 'mei-ling-contact'],
      },
      {
        id: 'brother-ezekiel',
        name: 'Brother Ezekiel',
        title: 'Permanent Guest',
        description: 'A former Frontera outlaw turned traveling preacher. He took the cloth after his gang was wiped out and now seeks redemption. He knows the old outlaw ways and sometimes helps those seeking to escape that life.',
        personality: 'Haunted but hopeful. Genuinely faithful now but carries dark memories. Helps outlaws find another path.',
        faction: 'FRONTERA',
        dialogue: [
          'The Lord forgives all sins. I\'m living proof.',
          'I rode with Martinez once. Then I found a different path.',
          'If you want out of the outlaw life, I know the way. Literally and spiritually.',
          'Agnes lets me stay for free. I help those who need guidance.',
        ],
        quests: ['redemption-path', 'outlaw-escape'],
      },
    ],
    availableActions: ['rent-room', 'rest', 'eat-meal', 'store-items', 'check-register', 'laundry-service'],
    availableCrimes: ['Burglarize Room', 'Pickpocket Guest', 'Steal Documents'],
    jobs: [
      {
        id: 'front-desk',
        name: 'Front Desk',
        description: 'Handle check-ins, reservations, and guest needs.',
        energyCost: 10,
        cooldownMinutes: 25,
        rewards: { goldMin: 10, goldMax: 18, xp: 18, items: [] },
        requirements: { minLevel: 2 },
      },
      {
        id: 'concierge',
        name: 'Concierge Service',
        description: 'Handle special requests and arrangements for wealthy guests.',
        energyCost: 15,
        cooldownMinutes: 40,
        rewards: { goldMin: 22, goldMax: 38, xp: 35, items: [] },
        requirements: { minLevel: 6 },
      },
      {
        id: 'hotel-security',
        name: 'Hotel Security',
        description: 'Protect guests, handle troublemakers, and maintain discretion.',
        energyCost: 20,
        cooldownMinutes: 50,
        rewards: { goldMin: 35, goldMax: 60, xp: 50, items: [] },
        requirements: { minLevel: 10 },
      },
    ],
    shops: [
      {
        id: 'dusty-trails-dining',
        name: 'Hotel Dining',
        description: 'Home-cooked meals and supplies.',
        shopType: 'general',
        items: [
          { itemId: 'hot-meal', name: 'Hot Meal', description: 'Hearty dinner', price: 2 },
          { itemId: 'coffee', name: 'Coffee', description: 'Strong and black', price: 1 },
          { itemId: 'packed-lunch', name: 'Packed Lunch', description: 'For the road', price: 3 },
          { itemId: 'room-key', name: 'Private Room (1 Night)', description: 'Rest and recover', price: 2 },
        ],
        buyMultiplier: 0.3,
      },
    ],
    secrets: [
      {
        id: 'guest-register',
        name: 'The Guest Register',
        description: 'Forty years of records. Every name, every date, every notation Agnes or Su Mei made. Politicians, outlaws, lovers meeting in secret, deals made over breakfast. A gold mine of blackmail material and historical evidence.',
        type: 'hidden_room',
        unlockCondition: {
          minReputation: 55,
          npcTrust: { npcId: 'agnes-miller', level: 4 },
        },
        content: {
          actions: ['study-registers', 'find-specific-guest', 'extract-pattern', 'blackmail-research'],
          npcs: [],
          dialogue: [
            'Forty years of secrets between these pages. The Governor\'s first visit, Martinez\'s hideout, the Judge\'s mistress.',
            'What you\'re looking for is probably here. Whether you should find it... that\'s your choice.',
          ],
        },
      },
    ],
    connections: [],
    dangerLevel: 1,
    factionInfluence: { settlerAlliance: 75, nahiCoalition: 5, frontera: 20 },
    isUnlocked: true,
    isHidden: false,
  },

  // =========================================================
  // UPPER TOWN - ELITE ESTABLISHMENTS (Phase 2)
  // Access: L5+, High Settler Rep, Low Wanted
  // =========================================================

  // ===== 9. GOVERNOR'S MANSION =====
  {
    _id: RED_GULCH_BUILDING_IDS.GOVERNORS_MANSION,
    name: "Governor's Mansion",
    description: 'The grandest building in Red Gulch, home to Governor Edmund Ashford during his territorial visits. Behind the polished facade of governance lies a web of corruption, bribery, and orders that have destroyed families and communities.',
    shortDescription: 'Seat of territorial power and corruption',
    type: 'government',
    region: 'town',
    parentId: LOCATION_IDS.RED_GULCH,
    tier: 3,
    dominantFaction: 'settler',
    operatingHours: { open: 8, close: 20 },
    atmosphere: 'Marble columns and velvet curtains hide rooms where fortunes are made and lives are ruined. Portraits of previous governors line the halls. Armed guards patrol silently. The smell of cigar smoke and expensive cologne lingers.',
    requirements: { minLevel: 5, minSettlerRep: 30, maxWanted: 20 },
    npcs: [
      {
        id: 'governor-ashford',
        name: 'Governor Edmund Ashford',
        title: 'Territorial Governor',
        description: 'A silver-haired man with cold eyes and an easy smile. He rose to power through strategic marriages, blackmail, and eliminating rivals. The Quiet Creek massacre was his order. The stolen claims fund his ambitions.',
        personality: 'Charming publicly, ruthless privately. Views people as resources to be used. Paranoid about his secrets.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'Ah, a citizen of the territory. How may the government serve you?',
          'Progress requires sacrifice. Not everyone understands that.',
          'The Nahi issue will be resolved. One way or another.',
          'My ledgers? Just financial records. Nothing of interest.',
        ],
        quests: ['political-favor', 'silence-witness'],
      },
      {
        id: 'edwin-graves',
        name: 'Edwin Graves',
        title: 'Personal Secretary',
        description: 'A nervous, thin man who manages the Governor\'s schedule and secrets. He knows everything—too much—and it\'s eating him alive. He\'s looking for a way out but fears the consequences.',
        personality: 'Anxious, guilty, and trapped. A potential whistleblower if given protection.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'The Governor is very busy. Perhaps I can help?',
          '*looks around nervously* Some things... shouldn\'t be in writing.',
          'I didn\'t know what I was getting into. Now I can\'t leave.',
          '*whispers* If someone could guarantee my safety... I know things.',
        ],
        quests: ['extract-whistleblower', 'find-evidence'],
      },
      {
        id: 'captain-beaumont',
        name: 'Captain Beaumont',
        title: 'Head of Security',
        description: 'A decorated military officer who believes in the Governor without question. He commands the mansion\'s guards with iron discipline and has personally "handled" several of the Governor\'s problems.',
        personality: 'Loyal, disciplined, and dangerously competent. True believer in the Governor\'s vision.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'State your business. The Governor\'s time is valuable.',
          'I served under him in the War. There\'s no finer leader.',
          'Threats to the territory are dealt with. Permanently.',
          'The Quiet Creek incident was a necessary measure. I was there.',
        ],
      },
    ],
    availableActions: ['request-audience', 'political-donation', 'file-petition', 'attend-function'],
    availableCrimes: ['Steal Documents', 'Blackmail Official', 'Plant Evidence', 'Assassinate'],
    jobs: [
      {
        id: 'official-courier',
        name: 'Official Courier',
        description: 'Deliver sensitive government documents throughout the territory.',
        energyCost: 15,
        cooldownMinutes: 40,
        rewards: { goldMin: 25, goldMax: 45, xp: 35, items: [] },
        requirements: { minLevel: 5 },
      },
      {
        id: 'campaign-fundraiser',
        name: 'Campaign Fundraiser',
        description: 'Collect "donations" from local businesses. Some are more voluntary than others.',
        energyCost: 18,
        cooldownMinutes: 50,
        rewards: { goldMin: 35, goldMax: 60, xp: 45, items: [] },
        requirements: { minLevel: 7 },
      },
      {
        id: 'special-assignment',
        name: 'Special Assignment',
        description: 'Handle tasks the Governor needs done quietly. Don\'t ask questions.',
        energyCost: 25,
        cooldownMinutes: 75,
        rewards: { goldMin: 55, goldMax: 95, xp: 65, items: [] },
        requirements: { minLevel: 10 },
      },
    ],
    shops: [],
    secrets: [
      {
        id: 'gilded-deck',
        name: 'The Gilded Deck',
        description: 'The Governor\'s private study contains the original orders for Quiet Creek, ledgers of bribes to judges and marshals, and evidence of land fraud going back decades. Political dynamite that could topple the territorial government.',
        type: 'hidden_room',
        unlockCondition: {
          minReputation: 80,
          npcTrust: { npcId: 'edwin-graves', level: 5 },
        },
        content: {
          actions: ['study-quiet-creek-orders', 'copy-bribe-ledgers', 'expose-government', 'blackmail-governor'],
          npcs: [],
          dialogue: [
            'These documents prove everything. The massacres, the thefts, the murders. What will you do with them?',
            'Graves risked his life to show you this. Don\'t waste his sacrifice.',
          ],
        },
      },
    ],
    connections: [],
    dangerLevel: 4,
    factionInfluence: { settlerAlliance: 95, nahiCoalition: 0, frontera: 5 },
    isUnlocked: true,
    isHidden: false,
  },

  // ===== 10. ASHFORD MINING COMPANY HQ =====
  {
    _id: RED_GULCH_BUILDING_IDS.ASHFORD_MINING_HQ,
    name: 'Ashford Mining Company HQ',
    description: 'The headquarters of the most powerful mining operation in the territory. "Big Bill" Harrison runs a brutal enterprise built on stolen claims, dangerous conditions, and workers who can\'t complain. The profits fund the Governor\'s campaigns.',
    shortDescription: 'Mining company headquarters with dark secrets',
    type: 'business',
    region: 'town',
    parentId: LOCATION_IDS.RED_GULCH,
    tier: 3,
    dominantFaction: 'settler',
    operatingHours: { open: 7, close: 19 },
    atmosphere: 'Maps of mining claims cover every wall. The smell of money and ambition. Workers wait nervously in the lobby while executives make deals that will destroy their lives. Deep in the basement, records of "incidents" are carefully filed.',
    requirements: { minLevel: 3 },
    npcs: [
      {
        id: 'big-bill-harrison',
        name: '"Big Bill" Harrison',
        title: 'Company President',
        description: 'A massive man with hands like shovels and a heart like stone. He started as a miner and clawed his way to the top by any means necessary. He owns half the claims in the territory—many taken by force or fraud.',
        personality: 'Ruthless, ambitious, and surprisingly intelligent. Respects strength and despises weakness.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'Time is money. What do you want?',
          'I built this company with my own hands. Well, mine and a few thousand workers\'.',
          'Safety regulations cost money. Dead workers are cheaper than lawsuits.',
          'The Governor and I have an understanding. A profitable understanding.',
        ],
        quests: ['acquire-claim', 'break-strike'],
      },
      {
        id: 'samuel-tucker',
        name: 'Samuel Tucker',
        title: 'Mine Foreman',
        description: 'A weathered man who rose from the mines to management. He follows orders but hates what the Company has become. He\'s seen too many men die and been forced to cover it up.',
        personality: 'Conflicted, guilty, but trapped. Drinks to forget. Potential ally for reformers.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'New worker? Fill out these forms. Don\'t expect to get out whole.',
          'I used to believe in this company. Before I saw the bodies.',
          '*drinking* Deep Tunnel Seven... they sealed it with men still inside.',
          'Harrison knows I know too much. That\'s why I\'m still alive—and that\'s why I can\'t leave.',
        ],
        quests: ['deep-tunnel-secret', 'protect-workers'],
      },
      {
        id: 'dr-silas-crane',
        name: 'Dr. Silas Crane',
        title: 'Company Physician',
        description: 'An alcoholic doctor who handles workplace injuries—and falsifies records to minimize the company\'s liability. His medical bag is never far from a whiskey bottle.',
        personality: 'Cynical, self-loathing, and deeply compromised. Sold his ethics years ago.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          '*slurring* Another one? Put him over there.',
          'Cause of death: Mining accident. They\'re always mining accidents.',
          'Don\'t look at me like that. You don\'t know what they make me write.',
          'I was a good doctor once. Before Harrison bought me.',
        ],
      },
    ],
    availableActions: ['apply-for-work', 'file-claim', 'request-meeting', 'investigate-records'],
    availableCrimes: ['Steal Payroll', 'Sabotage Equipment', 'Expose Records', 'Blackmail'],
    jobs: [
      {
        id: 'mining-shift',
        name: 'Mining Shift',
        description: 'Dangerous work in the company mines. High injury risk.',
        energyCost: 20,
        cooldownMinutes: 45,
        rewards: { goldMin: 15, goldMax: 28, xp: 25, items: [] },
        requirements: { minLevel: 1 },
      },
      {
        id: 'ore-transport',
        name: 'Ore Transport',
        description: 'Transport ore from mines to processing. Armed guards recommended.',
        energyCost: 18,
        cooldownMinutes: 40,
        rewards: { goldMin: 22, goldMax: 40, xp: 32, items: [] },
        requirements: { minLevel: 3 },
      },
      {
        id: 'company-security',
        name: 'Company Security',
        description: 'Protect company property and "discourage" union activities.',
        energyCost: 22,
        cooldownMinutes: 55,
        rewards: { goldMin: 35, goldMax: 60, xp: 48, items: [] },
        requirements: { minLevel: 6 },
      },
      {
        id: 'strikebreaker',
        name: 'Strikebreaker',
        description: 'Break up labor organizing. Violent work for violent pay.',
        energyCost: 28,
        cooldownMinutes: 70,
        rewards: { goldMin: 50, goldMax: 85, xp: 60, items: [] },
        requirements: { minLevel: 9 },
      },
      {
        id: 'claim-acquisition',
        name: 'Claim Acquisition',
        description: 'Acquire mining claims through legal means... or otherwise.',
        energyCost: 25,
        cooldownMinutes: 80,
        rewards: { goldMin: 60, goldMax: 100, xp: 75, items: [] },
        requirements: { minLevel: 12 },
      },
    ],
    shops: [
      {
        id: 'company-medical',
        name: 'Company Medical Supplies',
        description: 'Basic medical supplies at company prices.',
        shopType: 'medicine',
        items: [
          { itemId: 'bandages', name: 'Bandages', description: 'Company issue', price: 8 },
          { itemId: 'painkillers', name: 'Painkillers', description: 'Get back to work', price: 12 },
          { itemId: 'miners-tonic', name: 'Miner\'s Tonic', description: 'Energy boost', price: 15 },
        ],
        buyMultiplier: 0.3,
      },
    ],
    secrets: [
      {
        id: 'deep-tunnel-records',
        name: 'Deep Tunnel Records',
        description: 'Sealed files documenting the Deep Tunnel Seven collapse—where the company intentionally sealed the tunnel with workers inside to hide evidence of unsafe conditions. Also contains records of supernatural occurrences the company covered up.',
        type: 'hidden_room',
        unlockCondition: {
          minReputation: 65,
          npcTrust: { npcId: 'samuel-tucker', level: 4 },
        },
        content: {
          actions: ['study-incident-reports', 'list-victims', 'supernatural-evidence', 'expose-company'],
          npcs: [],
          dialogue: [
            'Forty-three men sealed in that tunnel. Harrison called it "acceptable losses."',
            'Something else came out of Deep Seven. Something that shouldn\'t exist.',
          ],
        },
      },
    ],
    connections: [],
    dangerLevel: 3,
    factionInfluence: { settlerAlliance: 90, nahiCoalition: 0, frontera: 10 },
    isUnlocked: true,
    isHidden: false,
  },

  // ===== 11. THE GILDED PEACOCK (Elite Club) =====
  {
    _id: RED_GULCH_BUILDING_IDS.GILDED_PEACOCK,
    name: 'The Gilded Peacock',
    description: 'The most exclusive establishment in Red Gulch, where the territory\'s elite gamble, scheme, and make deals that shape the frontier. Madame Victoria Sterling runs a house of pleasure, information, and power.',
    shortDescription: 'Elite club for gambling, deals, and secrets',
    type: 'entertainment',
    region: 'town',
    parentId: LOCATION_IDS.RED_GULCH,
    tier: 3,
    dominantFaction: 'settler',
    operatingHours: { open: 18, close: 6 },
    atmosphere: 'Crystal chandeliers cast golden light on velvet and silk. The air smells of expensive perfume and cigar smoke. Beautiful people in elegant dress circulate among the powerful. Every conversation is observed, every secret catalogued.',
    requirements: { minLevel: 6, minSettlerRep: 40, maxWanted: 10 },
    npcs: [
      {
        id: 'victoria-sterling',
        name: 'Madame Victoria Sterling',
        title: 'Proprietress',
        description: 'The most powerful woman in the territory. She built the Peacock from nothing and now holds the secrets of every politician, businessman, and outlaw who ever walked through her doors. Stunningly beautiful and terrifyingly intelligent.',
        personality: 'Refined, calculating, and absolutely ruthless. Uses information like a weapon. Respects power and intelligence.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'Welcome to the Peacock. All pleasures have a price. All secrets have a buyer.',
          'I don\'t traffic in flesh. I traffic in influence. Far more valuable.',
          'The Governor, Harrison, Martinez—they all come to me eventually.',
          'Every private room has ears. Every conversation is remembered. Choose your words carefully.',
        ],
        quests: ['acquire-secret', 'arrange-meeting', 'blackmail-target'],
      },
      {
        id: 'charles-montgomery',
        name: 'Charles Montgomery',
        title: 'Head Dealer',
        description: 'A dapper man with quick hands and quicker eyes. He runs the high-stakes games and can spot a cheat from across the room. Fiercely loyal to Victoria.',
        personality: 'Professional, observant, and dangerous when crossed. The last line of defense.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'Minimum buy-in is five hundred. House rules apply.',
          'Cheating at my tables ends one of two ways. Neither is pleasant.',
          'Madame Sterling sees everything. I just handle the details.',
        ],
      },
      {
        id: 'judge-whitmore',
        name: 'Judge Cornelius Whitmore',
        title: 'Regular Patron',
        description: 'A corrupt territorial judge who spends more time at the Peacock than the courthouse. He\'s sold more verdicts than a cattle auction. Victoria owns him completely.',
        personality: 'Pompous, lecherous, and utterly compromised. A tool to be used.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          '*drunk* Another bourbon! Put it on my tab.',
          'The law? The law is whatever I say it is.',
          'Victoria is a wonderful hostess. Simply wonderful.',
          'That case you mentioned? For the right consideration, I\'m sure we can work something out.',
        ],
        quests: ['bribe-judge', 'fix-verdict'],
      },
    ],
    availableActions: ['high-stakes-gambling', 'request-private-room', 'buy-information', 'attend-party'],
    availableCrimes: ['Cheat at High Stakes', 'Bribe Judge', 'Steal Jewelry', 'Blackmail Patron'],
    jobs: [
      {
        id: 'peacock-service',
        name: 'Peacock Service',
        description: 'Attend to the needs of elite guests. Observe and report.',
        energyCost: 12,
        cooldownMinutes: 35,
        rewards: { goldMin: 20, goldMax: 38, xp: 30, items: [] },
        requirements: { minLevel: 4 },
      },
      {
        id: 'information-brokering',
        name: 'Information Brokering',
        description: 'Buy, sell, and trade secrets among the elite. Victoria takes her cut.',
        energyCost: 18,
        cooldownMinutes: 50,
        rewards: { goldMin: 40, goldMax: 70, xp: 50, items: [] },
        requirements: { minLevel: 8 },
      },
      {
        id: 'discrete-arrangements',
        name: 'Discrete Arrangements',
        description: 'Handle sensitive matters for powerful clients. No questions, no records.',
        energyCost: 25,
        cooldownMinutes: 70,
        rewards: { goldMin: 55, goldMax: 95, xp: 65, items: [] },
        requirements: { minLevel: 11 },
      },
    ],
    shops: [
      {
        id: 'peacock-bar',
        name: 'Peacock Bar',
        description: 'The finest spirits and refreshments.',
        shopType: 'general',
        items: [
          { itemId: 'champagne', name: 'French Champagne', description: 'Imported luxury', price: 30 },
          { itemId: 'fine-brandy', name: 'Fine Brandy', description: 'Napoleon\'s finest', price: 25 },
          { itemId: 'cuban-cigar', name: 'Cuban Cigar', description: 'Hand-rolled', price: 20 },
          { itemId: 'peacock-token', name: 'Peacock Token', description: 'VIP access token', price: 100, requiredLevel: 8 },
        ],
        buyMultiplier: 0.2,
      },
    ],
    secrets: [
      {
        id: 'victorias-web',
        name: "Victoria's Web",
        description: 'A hidden room containing decades of recorded conversations, compromising photographs, and detailed files on every powerful person in the territory. Victoria\'s true power lies here.',
        type: 'hidden_room',
        unlockCondition: {
          minReputation: 85,
          npcTrust: { npcId: 'victoria-sterling', level: 5 },
        },
        content: {
          actions: ['study-files', 'access-recordings', 'select-target', 'leverage-information'],
          npcs: [],
          dialogue: [
            'You\'ve earned the right to see my collection. Handle it wisely—or not at all.',
            'Every powerful man in the territory has a file here. Including the Governor.',
          ],
        },
      },
    ],
    connections: [],
    dangerLevel: 4,
    factionInfluence: { settlerAlliance: 70, nahiCoalition: 5, frontera: 25 },
    isUnlocked: true,
    isHidden: false,
  },

  // =========================================================
  // LOWER TOWN - WORKING CLASS (Phase 3)
  // Access: Open to all, safe harbor for outlaws
  // =========================================================

  // ===== 12. THE LABOR EXCHANGE =====
  {
    _id: RED_GULCH_BUILDING_IDS.LABOR_EXCHANGE,
    name: 'The Labor Exchange',
    description: 'Where workers find jobs and organizers find trouble. Sarah McKenna runs the only labor union in the territory from these crowded rooms, fighting against company exploitation one strike at a time.',
    shortDescription: 'Day labor hiring and secret union headquarters',
    type: 'labor',
    region: 'town',
    parentId: LOCATION_IDS.RED_GULCH,
    tier: 3,
    dominantFaction: 'settler',
    operatingHours: { open: 5, close: 20 },
    atmosphere: 'Desperate men crowd the benches waiting for work. A chalk board lists available jobs. In the back, behind a false wall, workers gather to plan resistance against the Company. The smell of sweat and hope mingles.',
    npcs: [
      {
        id: 'sarah-mckenna',
        name: 'Sarah McKenna',
        title: 'Labor Organizer',
        description: 'A fierce Irish woman whose husband died in Company Mine Three. She\'s dedicated her life to organizing workers and fighting for fair conditions. The Company has tried to kill her twice.',
        personality: 'Passionate, fearless, and inspiring. A natural leader who\'d die for her cause—and might.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'Looking for honest work or looking to make a difference?',
          'My husband died because the Company cared more about profits than safety.',
          'They call us troublemakers. I call us survivors.',
          'The union isn\'t just about wages. It\'s about dignity.',
        ],
        quests: ['organize-miners', 'protect-union-meeting', 'expose-wage-theft'],
      },
      {
        id: 'henry-jobs',
        name: 'Henry Jobs',
        title: 'Manager',
        description: 'The official manager of the Exchange, a nervous man caught between the Company\'s demands and the workers\' needs. He looks the other way when Sarah holds her meetings.',
        personality: 'Anxious, sympathetic, and quietly supportive. Fears losing his job.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'Jobs posted on the board. First come, first served.',
          'The Company? They just want workers. They don\'t ask how I find them.',
          '*whispers* Sarah\'s in the back. Tell her Henry sent you.',
        ],
      },
      {
        id: 'one-arm-mike',
        name: '"One-Arm" Mike',
        title: 'Injured Miner',
        description: 'Lost his arm in Company Mine Five and received nothing. He\'s become Sarah\'s most dedicated supporter and runs messages between union cells.',
        personality: 'Bitter, determined, and loyal. Lives to see the Company pay.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          '*holds up stump* Company said it was my fault. Twenty years of service, and this is what I got.',
          'Sarah gave me a purpose when I lost everything.',
          'We\'re building something here. Something they can\'t take away.',
        ],
      },
    ],
    availableActions: ['find-work', 'post-job', 'attend-meeting', 'join-union'],
    availableCrimes: ['Steal Wages', 'Sabotage Strike', 'Inform on Union'],
    jobs: [
      {
        id: 'light-day-labor',
        name: 'Light Day Labor',
        description: 'Basic manual work around town. Safe but pays poorly.',
        energyCost: 12,
        cooldownMinutes: 25,
        rewards: { goldMin: 8, goldMax: 15, xp: 15, items: [] },
        requirements: { minLevel: 1 },
      },
      {
        id: 'heavy-day-labor',
        name: 'Heavy Day Labor',
        description: 'Demanding physical work. Better pay, higher risk.',
        energyCost: 18,
        cooldownMinutes: 35,
        rewards: { goldMin: 15, goldMax: 28, xp: 25, items: [] },
        requirements: { minLevel: 2 },
      },
      {
        id: 'union-support',
        name: 'Union Support',
        description: 'Help with organizing efforts. Watch for Company spies.',
        energyCost: 15,
        cooldownMinutes: 40,
        rewards: { goldMin: 18, goldMax: 32, xp: 30, items: [] },
        requirements: { minLevel: 4 },
      },
      {
        id: 'picket-line',
        name: 'Picket Line Duty',
        description: 'Stand with workers during strikes. Dangerous when strikebreakers arrive.',
        energyCost: 20,
        cooldownMinutes: 50,
        rewards: { goldMin: 25, goldMax: 45, xp: 40, items: [] },
        requirements: { minLevel: 6 },
      },
    ],
    shops: [],
    secrets: [
      {
        id: 'organizing-room',
        name: 'The Organizing Room',
        description: 'Behind a false wall lies the secret headquarters of the territory\'s labor movement. Strike plans, lists of sympathizers, and evidence of Company crimes are carefully hidden here.',
        type: 'hidden_room',
        unlockCondition: {
          minReputation: 45,
          npcTrust: { npcId: 'sarah-mckenna', level: 3 },
        },
        content: {
          actions: ['attend-secret-meeting', 'study-strike-plans', 'access-evidence', 'contact-cells'],
          npcs: ['one-arm-mike'],
          dialogue: [
            'Welcome to the real Exchange. Here, we plan for a better future.',
            'Every worker who joins makes us stronger. Every strike brings us closer.',
          ],
        },
      },
    ],
    connections: [],
    dangerLevel: 3,
    factionInfluence: { settlerAlliance: 60, nahiCoalition: 20, frontera: 20 },
    isUnlocked: true,
    isHidden: false,
  },

  // ===== 13. THE SLOP HOUSE (Worker's Tavern) =====
  {
    _id: RED_GULCH_BUILDING_IDS.SLOP_HOUSE,
    name: 'The Slop House',
    description: 'The working man\'s tavern, where miners drink away their sorrows and secrets flow like cheap whiskey. "Mag" Sullivan knows everyone and everything in Lower Town, and for the right price, she\'ll share.',
    shortDescription: 'Worker\'s tavern and information hub',
    type: 'saloon',
    region: 'town',
    parentId: LOCATION_IDS.RED_GULCH,
    tier: 3,
    dominantFaction: 'settler',
    operatingHours: { open: 6, close: 3 },
    atmosphere: 'Sawdust on the floor, spit on the walls. The smell of cheap beer and desperation. Workers crowd the bar after shifts, spending what little they earned. In corners, quieter deals are made.',
    npcs: [
      {
        id: 'mag-sullivan',
        name: '"Mag" Sullivan',
        title: 'Barkeeper',
        description: 'A heavyset woman with arms like hams and ears like radar. She\'s poured drinks for every worker in the territory and knows their secrets, their fears, and their debts. Nothing happens in Lower Town without Mag knowing.',
        personality: 'Tough, shrewd, and surprisingly kind. Protects her regulars. Sells information to survive.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'What\'ll it be? We got cheap and cheaper.',
          'I hear things. These walls have ears—mine.',
          'Company man comes sniffing? Never seen you. Never heard your name.',
          'Information costs. But I trade fair.',
        ],
        quests: ['gather-rumors', 'find-missing-worker'],
      },
      {
        id: 'prospector-jim',
        name: '"Prospector" Jim',
        title: 'Old-Timer',
        description: 'A grizzled old prospector who\'s been searching for the mother lode for thirty years. He knows every inch of the territory and tells tales of ghosts, gold, and things best left buried.',
        personality: 'Eccentric, knowledgeable, and possibly crazy. His stories are wild but sometimes true.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'Buy me a drink and I\'ll tell you about the Lost Dutchman\'s mine.',
          'Thirty years searching. I know things these young folks don\'t.',
          'There\'s gold in them hills. And things guarding it. Things that ain\'t natural.',
          'The Company dug too deep in Seven. Woke something up.',
        ],
        quests: ['lost-mine', 'prospector-tales'],
      },
      {
        id: 'chang-wei',
        name: 'Chang Wei',
        title: 'Dishwasher',
        description: 'A young Chinese man who works in the back but serves as a bridge between Lower Town and the Chinese Quarter. He carries messages, arranges meetings, and never forgets a face.',
        personality: 'Quiet, reliable, and deeply connected. The link between two worlds.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          '*washing dishes* You need something?',
          'I know people. People who can help. For the right reasons.',
          'The Chinese Quarter? I can arrange introduction. If you\'re worthy.',
          'Mei Ling trusts me. That trust is not given lightly.',
        ],
        quests: ['chinese-quarter-introduction', 'underground-message'],
      },
    ],
    availableActions: ['drink', 'gather-rumors', 'post-message', 'hire-guide'],
    availableCrimes: ['Bar Fight', 'Pick Drunk\'s Pocket', 'Sell Information'],
    jobs: [
      {
        id: 'slop-house-security',
        name: 'Slop House Security',
        description: 'Keep order in a room full of drunk miners. Not for the faint of heart.',
        energyCost: 15,
        cooldownMinutes: 30,
        rewards: { goldMin: 15, goldMax: 28, xp: 25, items: [] },
        requirements: { minLevel: 2 },
      },
      {
        id: 'ear-to-ground',
        name: 'Ear to the Ground',
        description: 'Listen, remember, report. Mag pays well for good information.',
        energyCost: 12,
        cooldownMinutes: 35,
        rewards: { goldMin: 18, goldMax: 35, xp: 30, items: [] },
        requirements: { minLevel: 4 },
      },
      {
        id: 'message-runner',
        name: 'Message Runner',
        description: 'Carry messages through Lower Town. Discretion required.',
        energyCost: 10,
        cooldownMinutes: 25,
        rewards: { goldMin: 12, goldMax: 22, xp: 20, items: [] },
        requirements: { minLevel: 2 },
      },
    ],
    shops: [
      {
        id: 'slop-house-bar',
        name: 'Slop House Bar',
        description: 'Cheap drinks for working folk.',
        shopType: 'general',
        items: [
          { itemId: 'rotgut-whiskey', name: 'Rotgut Whiskey', description: 'Burns going down', price: 1 },
          { itemId: 'miners-beer', name: 'Miner\'s Beer', description: 'Watered but cold', price: 1 },
          { itemId: 'mystery-stew', name: 'Mystery Stew', description: 'Don\'t ask', price: 2 },
        ],
        buyMultiplier: 0.4,
      },
    ],
    secrets: [
      {
        id: 'mags-network',
        name: "Mag's Network",
        description: 'Mag maintains contacts throughout the territory—bartenders, maids, stable hands, all feeding her information. Her network rivals Victoria Sterling\'s but serves the common folk instead of the elite.',
        type: 'hidden_room',
        unlockCondition: {
          minReputation: 50,
          npcTrust: { npcId: 'mag-sullivan', level: 4 },
        },
        content: {
          actions: ['access-network', 'send-message', 'request-intelligence', 'coordinate-contacts'],
          npcs: [],
          dialogue: [
            'My people are everywhere. Invisible to the fancy folk but always watching.',
            'Victoria has her web. I have mine. Ours just cares about different things.',
          ],
        },
      },
    ],
    connections: [],
    dangerLevel: 5,
    factionInfluence: { settlerAlliance: 55, nahiCoalition: 15, frontera: 30 },
    isUnlocked: true,
    isHidden: false,
  },

  // ===== 14. TENT CITY (Miner Camp) =====
  {
    _id: RED_GULCH_BUILDING_IDS.TENT_CITY,
    name: 'Tent City',
    description: 'A sprawling camp of tents and shacks where the desperate, the hopeful, and the damned make their homes. Preacher Ezekiel Jones tends to souls while "Crazy" Mary mumbles about spirits and gold. The Company pretends it doesn\'t exist.',
    shortDescription: 'Makeshift camp for desperate miners and outcasts',
    type: 'camp',
    region: 'town',
    parentId: LOCATION_IDS.RED_GULCH,
    tier: 3,
    dominantFaction: 'settler',
    operatingHours: { open: 0, close: 23 },
    atmosphere: 'Canvas tents flap in the wind. Campfires flicker against the darkness. The smell of unwashed bodies and cooking beans. Children play in the dust while their parents dream of striking it rich. At night, strange sounds come from the hills.',
    requirements: { maxWanted: 50 },
    npcs: [
      {
        id: 'preacher-jones',
        name: 'Preacher Ezekiel Jones',
        title: 'Camp Minister',
        description: 'A selfless man who gave up a comfortable church to minister to those society forgot. He feeds the hungry, buries the dead, and offers hope to the hopeless. The only truly good man in Red Gulch.',
        personality: 'Compassionate, tireless, and genuinely faithful. Believes in redemption for all.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'All are welcome in God\'s sight. Rest here, friend.',
          'I came to serve those who have nothing. That\'s where God is needed most.',
          'The Company calls them failures. I call them my flock.',
          'Mary\'s visions trouble me. She sees things that... shouldn\'t be seen.',
        ],
        quests: ['feed-hungry', 'bury-dead', 'find-hope'],
      },
      {
        id: 'crazy-mary',
        name: '"Crazy" Mary',
        title: 'Prospector',
        description: 'An old woman who\'s been prospecting for forty years. She talks to spirits, sees visions, and knows things she shouldn\'t. Most dismiss her as mad, but her predictions have an unsettling accuracy.',
        personality: 'Eccentric, prophetic, and possibly touched by something supernatural. Speaks in riddles.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          '*muttering* The spirits whisper... gold and blood, blood and gold...',
          'You seek my claim? The spirits showed me where. But the Company took it.',
          'Deep Tunnel Seven... the dead still work there. I hear their picks.',
          '*suddenly lucid* Listen. Something old woke up in these hills. Something hungry.',
        ],
        quests: ['marys-visions', 'lost-claim'],
      },
      {
        id: 'dan-murphy',
        name: 'Dan Murphy',
        title: 'Desperate Miner',
        description: 'A family man who brought his wife and children west chasing gold. Now he takes any work to keep them fed. He\'s one bad break from joining the outlaws.',
        personality: 'Desperate, hardworking, and increasingly hopeless. A good man pushed to the edge.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'You got work? Any work? I got mouths to feed.',
          'We came out here with such hope. Now I don\'t know if we\'ll survive winter.',
          'The Company won\'t hire me. Said I\'m "trouble." I just asked about safety.',
          'If things don\'t change... I don\'t know what I\'ll do. But my family will eat.',
        ],
        quests: ['help-murphy-family', 'find-work'],
      },
    ],
    availableActions: ['rest', 'pray', 'seek-vision', 'help-camp', 'hide'],
    availableCrimes: ['Steal Food', 'Rob Tent', 'Sell to Desperate'],
    jobs: [
      {
        id: 'creek-panning',
        name: 'Creek Panning',
        description: 'Pan for gold in the creek. Backbreaking work for occasional flakes.',
        energyCost: 15,
        cooldownMinutes: 30,
        rewards: { goldMin: 5, goldMax: 20, xp: 18, items: [] },
        requirements: { minLevel: 1 },
      },
      {
        id: 'scavenging',
        name: 'Scavenging',
        description: 'Search the outskirts for useful items. You\'d be surprised what people throw away.',
        energyCost: 12,
        cooldownMinutes: 25,
        rewards: { goldMin: 8, goldMax: 18, xp: 15, items: [] },
        requirements: { minLevel: 1 },
      },
      {
        id: 'dangerous-work',
        name: 'Dangerous Work',
        description: 'Jobs no one else will take. High pay because high risk.',
        energyCost: 25,
        cooldownMinutes: 55,
        rewards: { goldMin: 30, goldMax: 55, xp: 45, items: [] },
        requirements: { minLevel: 5 },
      },
      {
        id: 'claim-scouting',
        name: 'Claim Scouting',
        description: 'Search for unclaimed veins in dangerous territory.',
        energyCost: 20,
        cooldownMinutes: 45,
        rewards: { goldMin: 22, goldMax: 42, xp: 38, items: [] },
        requirements: { minLevel: 4 },
      },
    ],
    shops: [],
    secrets: [
      {
        id: 'marys-secret-claim',
        name: "Mary's Secret Claim",
        description: 'Twenty years ago, Mary found the richest vein in the territory. The Company took it by force, killed her partner, and called her crazy. She still knows where other veins lie—veins they never found.',
        type: 'hidden_room',
        unlockCondition: {
          minReputation: 55,
          npcTrust: { npcId: 'crazy-mary', level: 4 },
        },
        content: {
          actions: ['learn-locations', 'hear-full-story', 'plan-expedition', 'contact-spirits'],
          npcs: [],
          dialogue: [
            'The spirits showed me where the gold sleeps. Some places the Company doesn\'t know.',
            'Help me get justice for my partner, and I\'ll share what I know.',
          ],
        },
      },
    ],
    connections: [],
    dangerLevel: 6,
    factionInfluence: { settlerAlliance: 45, nahiCoalition: 25, frontera: 30 },
    isUnlocked: true,
    isHidden: false,
  },

  // =========================================================
  // CHINESE QUARTER - HIDDEN DISTRICT (Phase 4)
  // Access: Discoverable through Mei Ling's Laundry
  // =========================================================

  // ===== 15. MEI LING'S LAUNDRY (Entry Point - VISIBLE) =====
  {
    _id: RED_GULCH_BUILDING_IDS.MEI_LINGS_LAUNDRY,
    name: "Mei Ling's Laundry",
    description: 'A humble laundry business that serves as the gateway to the Chinese Quarter. Mei Ling appears to be a simple washerwoman, but she runs the most sophisticated intelligence network in the territory and provides sanctuary for her persecuted community.',
    shortDescription: 'Laundry service and gateway to Chinese Quarter',
    type: 'service',
    region: 'town',
    parentId: LOCATION_IDS.RED_GULCH,
    tier: 3,
    dominantFaction: 'settler',
    operatingHours: { open: 6, close: 22 },
    atmosphere: 'Steam rises from boiling vats. The smell of lye soap and pressed cloth. Chinese workers move efficiently between stations. Mei Ling watches everyone who enters with eyes that miss nothing. A locked door leads to the back.',
    npcs: [
      {
        id: 'mei-ling',
        name: 'Mei Ling',
        title: 'Proprietress',
        description: 'The unofficial leader of Red Gulch\'s Chinese community. She appears to be a gentle, middle-aged washerwoman, but she runs an underground railroad for persecuted workers and maintains files on every powerful person in the territory.',
        personality: 'Intelligent, calculating, and deeply protective. Plays the "simple Chinese woman" role perfectly while orchestrating complex operations.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          '*in accented English* Welcome, welcome. You have laundry? Good prices.',
          '*observing* Your clothes tell stories. Blood stains, gun oil, expensive fabric...',
          '*in Mandarin* 他不简单... *in English* ...yes, very nice fabric.',
          '*privately* You\'ve shown kindness to my people. Perhaps we can help each other.',
        ],
        quests: ['earn-trust', 'protect-community', 'underground-railroad'],
      },
      {
        id: 'li-wei-runner',
        name: 'Li Wei',
        title: 'Runner',
        description: 'A quick-witted twelve-year-old who delivers laundry and messages throughout town. He goes places adults can\'t and hears things people don\'t realize children understand.',
        personality: 'Clever, brave, and fiercely loyal to Mei Ling. The eyes and ears of the Quarter.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'Laundry delivery! *examines you* You\'re the one Auntie mentioned.',
          'I go everywhere. People don\'t notice kids. I notice everything.',
          'The Governor\'s mansion? I deliver sheets there. Nice people don\'t see servants.',
          '*running* Can\'t talk! Lots of deliveries!',
        ],
      },
      {
        id: 'widow-chen',
        name: 'Widow Chen',
        title: 'Senior Worker',
        description: 'An elderly woman who has worked in Mei Ling\'s laundry for twenty years. She speaks little but observes everything. She lost her husband and sons to the railroad.',
        personality: 'Silent, watchful, and utterly loyal. Carries deep grief and determination.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          '*silent nod*',
          '*in Cantonese* 这个人... *in English* ...many questions.',
          '*folding laundry* Railroad took my family. Mei Ling gave me new one.',
        ],
      },
    ],
    availableActions: ['laundry-service', 'document-recovery', 'speak-privately', 'request-introduction'],
    availableCrimes: ['Rob Business', 'Extort Protection'],
    jobs: [
      {
        id: 'laundry-work',
        name: 'Laundry Work',
        description: 'Honest work washing and pressing clothes.',
        energyCost: 10,
        cooldownMinutes: 25,
        rewards: { goldMin: 8, goldMax: 15, xp: 15, items: [] },
        requirements: { minLevel: 1 },
      },
      {
        id: 'delivery-service',
        name: 'Delivery Service',
        description: 'Deliver laundry throughout town. Learn the layout, observe the powerful.',
        energyCost: 12,
        cooldownMinutes: 30,
        rewards: { goldMin: 12, goldMax: 22, xp: 20, items: [] },
        requirements: { minLevel: 2 },
      },
      {
        id: 'document-analysis',
        name: 'Document Analysis',
        description: 'Examine papers found in pockets. Information is valuable.',
        energyCost: 15,
        cooldownMinutes: 40,
        rewards: { goldMin: 20, goldMax: 38, xp: 32, items: [] },
        requirements: { minLevel: 4 },
      },
      {
        id: 'community-protection',
        name: 'Community Protection',
        description: 'Protect Chinese workers from harassment. Make a difference.',
        energyCost: 18,
        cooldownMinutes: 45,
        rewards: { goldMin: 25, goldMax: 45, xp: 40, items: [] },
        requirements: { minLevel: 6 },
      },
      {
        id: 'active-intelligence',
        name: 'Active Intelligence',
        description: 'Conduct intelligence operations for Mei Ling. High risk, high reward.',
        energyCost: 25,
        cooldownMinutes: 65,
        rewards: { goldMin: 45, goldMax: 80, xp: 60, items: [] },
        requirements: { minLevel: 10 },
      },
    ],
    shops: [
      {
        id: 'mei-ling-services',
        name: 'Laundry Services',
        description: 'Laundry and... special services.',
        shopType: 'general',
        items: [
          { itemId: 'clean-clothes', name: 'Clothing Cleaning', description: 'Remove evidence', price: 5 },
          { itemId: 'disguise-cleaning', name: 'Disguise Cleaning', description: 'Make disguise look authentic', price: 25, requiredLevel: 5 },
          { itemId: 'document-recovery', name: 'Document Recovery', description: 'Retrieve important papers from laundry', price: 50, requiredLevel: 8 },
        ],
        buyMultiplier: 0.5,
      },
    ],
    secrets: [
      {
        id: 'safe-passage-network',
        name: 'Safe Passage Network',
        description: 'Mei Ling\'s true operation: an underground railroad for persecuted Chinese workers, complete with safe houses, forged papers, and escape routes. Also contains intelligence files on every powerful person in the territory.',
        type: 'hidden_room',
        unlockCondition: {
          minReputation: 60,
          npcTrust: { npcId: 'mei-ling', level: 4 },
        },
        content: {
          actions: ['access-safe-houses', 'study-files', 'arrange-escape', 'coordinate-network'],
          npcs: ['li-wei-runner'],
          dialogue: [
            'You have proven your heart. Welcome to the real work.',
            'We save lives, gather information, and wait for our moment.',
          ],
        },
      },
    ],
    connections: [],
    dangerLevel: 2,
    factionInfluence: { settlerAlliance: 50, nahiCoalition: 20, frontera: 30 },
    isUnlocked: true,
    isHidden: false,
  },

  // ===== 16. CHEN'S APOTHECARY (Hidden - Unlock via Mei Ling) =====
  {
    _id: RED_GULCH_BUILDING_IDS.CHENS_APOTHECARY,
    name: "Chen's Apothecary",
    description: 'A traditional Chinese medicine shop hidden in the Quarter. Master Chen Liu practices healing arts passed down for five hundred years. Some of his remedies border on the miraculous—and the supernatural.',
    shortDescription: 'Traditional medicine and ancient remedies',
    type: 'apothecary',
    region: 'town',
    parentId: LOCATION_IDS.RED_GULCH,
    tier: 3,
    dominantFaction: 'settler',
    operatingHours: { open: 8, close: 18 },
    atmosphere: 'Dried herbs hang from the ceiling. Mysterious jars line the walls. The smell of ginseng and ancient remedies. Master Chen moves slowly between patients, his eyes seeing things beyond the physical.',
    requirements: { minLevel: 2 },
    npcs: [
      {
        id: 'master-chen-liu',
        name: 'Master Chen Liu',
        title: 'Herbalist',
        description: 'An ancient man who carries knowledge from the old country. His remedies heal ailments Western medicine cannot touch. Some whisper his oldest formulas have supernatural effects.',
        personality: 'Patient, wise, and mysterious. Speaks in riddles. Sees the spirit as well as the body.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          '*examines you* Your qi is disturbed. Sit.',
          'Five hundred years, these formulas. Passed from master to student.',
          'Western medicine treats the body. We treat the spirit that dwells within.',
          'Some ailments require herbs. Some require... older remedies.',
        ],
        quests: ['rare-herbs', 'ancient-formula'],
      },
      {
        id: 'li-hua',
        name: 'Li Hua',
        title: 'Apprentice',
        description: 'A young woman torn between traditional medicine and the modern world. She\'s learning the old ways but wonders if there\'s more beyond the Quarter.',
        personality: 'Curious, conflicted, and talented. Bridge between old and new.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          '*grinding herbs* Master says I have the gift. I\'m not sure what that means.',
          'The old ways work. But the new world doesn\'t believe.',
          'Sometimes I dream of San Francisco. A real life.',
          'Master Chen sees things. I\'m starting to see them too.',
        ],
      },
    ],
    availableActions: ['buy-remedies', 'request-treatment', 'consult-master', 'learn-recipes'],
    availableCrimes: ['Steal Remedies', 'Sell Secret Formulas'],
    jobs: [
      {
        id: 'herb-gathering',
        name: 'Herb Gathering',
        description: 'Collect medicinal herbs from the surrounding wilderness.',
        energyCost: 15,
        cooldownMinutes: 35,
        rewards: { goldMin: 15, goldMax: 28, xp: 25, items: [] },
        requirements: { minLevel: 3 },
      },
      {
        id: 'medicine-delivery',
        name: 'Medicine Delivery',
        description: 'Deliver remedies to patients who cannot travel.',
        energyCost: 12,
        cooldownMinutes: 30,
        rewards: { goldMin: 12, goldMax: 22, xp: 20, items: [] },
        requirements: { minLevel: 2 },
      },
      {
        id: 'remedy-brewing',
        name: 'Remedy Brewing',
        description: 'Assist Master Chen with complex preparations.',
        energyCost: 18,
        cooldownMinutes: 45,
        rewards: { goldMin: 25, goldMax: 45, xp: 40, items: [] },
        requirements: { minLevel: 5 },
      },
    ],
    shops: [
      {
        id: 'chens-remedies',
        name: "Chen's Remedies",
        description: 'Traditional Chinese medicine.',
        shopType: 'medicine',
        items: [
          { itemId: 'healing-tea', name: 'Healing Tea', description: 'Restores 20 HP over time', price: 8 },
          { itemId: 'green-tea', name: 'Green Tea', description: 'Restores 5 energy', price: 3 },
          { itemId: 'lung-tonic', name: 'Lung Tonic', description: 'Cures respiratory ailments', price: 25 },
          { itemId: 'qi-tonic', name: 'Qi Tonic', description: 'Restores stamina (+20 energy)', price: 30, requiredLevel: 5 },
          { itemId: 'universal-antidote', name: 'Universal Antidote', description: 'Cures most poisons', price: 75, requiredLevel: 6 },
          { itemId: 'tiger-balm', name: 'Tiger Balm', description: 'Healing +50% for 1 hour', price: 60, requiredLevel: 8 },
          { itemId: 'longevity-tea', name: 'Longevity Tea', description: 'Mysterious rejuvenating effects', price: 200, requiredLevel: 12 },
        ],
        buyMultiplier: 0.5,
      },
    ],
    secrets: [
      {
        id: 'secret-formulae',
        name: 'Secret Formulae',
        description: 'Master Chen\'s most ancient remedies, passed down for five centuries. Some have effects that defy natural explanation—healing that shouldn\'t be possible, visions of truth, protection against supernatural harm.',
        type: 'hidden_room',
        unlockCondition: {
          minReputation: 65,
          npcTrust: { npcId: 'master-chen-liu', level: 5 },
        },
        content: {
          actions: ['learn-secret-formula', 'brew-ancient-remedy', 'understand-supernatural'],
          npcs: ['li-hua'],
          dialogue: [
            'These formulas are not of the natural world. Use them with wisdom.',
            'The old spirits gifted these to our ancestors. We are merely custodians.',
          ],
        },
      },
    ],
    connections: [],
    dangerLevel: 1,
    factionInfluence: { settlerAlliance: 40, nahiCoalition: 30, frontera: 30 },
    isUnlocked: false,
    isHidden: true,
  },

  // ===== 17. DRAGON GATE TEA HOUSE (Hidden - Unlock via Mei Ling) =====
  {
    _id: RED_GULCH_BUILDING_IDS.DRAGON_GATE_TEA_HOUSE,
    name: 'Dragon Gate Tea House',
    description: 'More than a tea house, this is the information hub of the Chinese community. Mr. Huang Jin trades secrets while Grandmother Wu reads fortunes with unsettling accuracy. An alternative to Victoria Sterling\'s network, accessible to those the elite ignore.',
    shortDescription: 'Information trading and fortune telling',
    type: 'tea_house',
    region: 'town',
    parentId: LOCATION_IDS.RED_GULCH,
    tier: 3,
    dominantFaction: 'settler',
    operatingHours: { open: 10, close: 22 },
    atmosphere: 'Paper lanterns cast soft light on low tables. The smell of jasmine tea and incense. Quiet conversations in Cantonese and Mandarin. In the corner, Grandmother Wu shuffles her cards, her milky eyes seeing far beyond this room.',
    requirements: { minLevel: 3 },
    npcs: [
      {
        id: 'huang-jin',
        name: 'Mr. Huang Jin',
        title: 'Proprietor',
        description: 'A refined man who runs the tea house and the most extensive information network outside the Gilded Peacock. His sources—servants, laborers, laundry workers—see everything the powerful do.',
        personality: 'Cultured, calculating, and patient. Trades in information like currency. Plays the long game.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          'Welcome, welcome. Tea? We have many varieties.',
          'Information flows like water. To me, from me. The question is price.',
          'Victoria Sterling thinks she knows everything. She doesn\'t know what servants see.',
          'The railroad workers, the cooks, the laundresses—they are invisible. And they report to me.',
        ],
        quests: ['trade-information', 'infiltrate-network'],
      },
      {
        id: 'grandmother-wu',
        name: 'Grandmother Wu',
        title: 'Fortune Teller',
        description: 'A blind woman whose visions are frighteningly accurate. She reads fortune cards, interprets dreams, and sometimes speaks of things that haven\'t happened yet. Some believe she\'s touched by the spirit world.',
        personality: 'Mysterious, prophetic, and unsettling. Speaks truths people don\'t want to hear.',
        faction: 'SETTLER_ALLIANCE',
        dialogue: [
          '*shuffling cards* You seek your fortune? Some truths are best unknown.',
          '*blind eyes staring* I see blood. Gold. A choice that will change everything.',
          'The old spirits speak through the cards. They remember when this land was different.',
          '*suddenly* The Deep Tunnel... they disturbed something ancient. It\'s awake.',
        ],
        quests: ['fortune-reading', 'interpret-vision'],
      },
    ],
    availableActions: ['drink-tea', 'request-fortune', 'trade-information', 'arrange-meeting'],
    availableCrimes: ['Sell False Information', 'Blackmail'],
    jobs: [
      {
        id: 'tea-service',
        name: 'Tea Service',
        description: 'Serve tea and observe. Every conversation has value.',
        energyCost: 10,
        cooldownMinutes: 28,
        rewards: { goldMin: 12, goldMax: 22, xp: 18, items: [] },
        requirements: { minLevel: 2 },
      },
      {
        id: 'information-courier',
        name: 'Information Courier',
        description: 'Carry messages between Huang Jin\'s contacts throughout the territory.',
        energyCost: 15,
        cooldownMinutes: 40,
        rewards: { goldMin: 22, goldMax: 40, xp: 35, items: [] },
        requirements: { minLevel: 5 },
      },
      {
        id: 'translation-services',
        name: 'Translation Services',
        description: 'Translate documents and conversations. Language is power.',
        energyCost: 14,
        cooldownMinutes: 35,
        rewards: { goldMin: 20, goldMax: 38, xp: 32, items: [] },
        requirements: { minLevel: 6 },
      },
      {
        id: 'intelligence-gathering',
        name: 'Intelligence Gathering',
        description: 'Active intelligence work. Recruit sources, verify information, analyze patterns.',
        energyCost: 22,
        cooldownMinutes: 55,
        rewards: { goldMin: 40, goldMax: 70, xp: 55, items: [] },
        requirements: { minLevel: 9 },
      },
    ],
    shops: [
      {
        id: 'dragon-gate-tea',
        name: 'Dragon Gate Teas',
        description: 'Fine teas from China.',
        shopType: 'general',
        items: [
          { itemId: 'jasmine-tea', name: 'Jasmine Tea', description: 'Calming and fragrant', price: 5 },
          { itemId: 'oolong-tea', name: 'Oolong Tea', description: 'Traditional variety', price: 8 },
          { itemId: 'dragon-well', name: 'Dragon Well Tea', description: 'Rare and precious', price: 25, requiredLevel: 5 },
          { itemId: 'fortune-reading', name: 'Fortune Reading', description: 'Grandmother Wu\'s wisdom', price: 20 },
        ],
        buyMultiplier: 0.4,
      },
    ],
    secrets: [
      {
        id: 'huangs-web',
        name: "Huang's Web",
        description: 'A complete map of Huang Jin\'s information network—servants in mansions, workers in mines, cooks in restaurants. A parallel to Victoria Sterling\'s web, built from those the powerful overlook.',
        type: 'hidden_room',
        unlockCondition: {
          minReputation: 70,
          npcTrust: { npcId: 'huang-jin', level: 4 },
        },
        content: {
          actions: ['access-network-map', 'contact-sources', 'request-specific-intelligence'],
          npcs: ['grandmother-wu'],
          dialogue: [
            'Victoria sees the powerful. I see through the eyes of the invisible.',
            'Every mansion has servants. Every servant has eyes. And they all report to me.',
          ],
        },
      },
    ],
    connections: [],
    dangerLevel: 2,
    factionInfluence: { settlerAlliance: 40, nahiCoalition: 25, frontera: 35 },
    isUnlocked: false,
    isHidden: true,
  },
];

/**
 * Seed Red Gulch buildings into the database
 */
export async function seedRedGulchBuildings(): Promise<void> {
  try {
    // Verify Red Gulch exists
    const redGulch = await Location.findById(LOCATION_IDS.RED_GULCH);
    if (!redGulch) {
      console.warn('Warning: Red Gulch location not found. Buildings will reference non-existent parent.');
    }

    // Delete existing Red Gulch buildings (by parentId)
    await Location.deleteMany({ parentId: LOCATION_IDS.RED_GULCH });

    // Insert Red Gulch buildings
    await Location.insertMany(redGulchBuildings);

    console.log(`Successfully seeded ${redGulchBuildings.length} Red Gulch buildings`);
  } catch (error) {
    logger.error('Error seeding Red Gulch buildings', { error: error instanceof Error ? error.message : error });
    throw error;
  }
}

export default redGulchBuildings;
